# 头盔|装具入门

> 原文：<https://www.harness.io/blog/getting-started-with-helm>

本教程旨在帮助读者从 GitHub 库部署一个舵图。这个存储库包含一个简单的 Helm 图表，您可以将它部署在您的公共 Kubernetes 集群上来演示 Helm with Harness！

随着 Kubernetes 的流行和广泛采用，安装、升级、维护和定义最复杂的 Kubernetes 应用程序的方法已经出现。

一种方法是手动部署 Kubernetes 清单文件，根据需要对其进行更改，这使得该过程冗长且容易出错，因为这种方法的部署不一致。对于新的 Kubernetes 集群，您需要定义名称空间，创建存储类，然后将应用程序部署到集群。如你所见，过程相当冗长，如果出了问题，查找问题就变成了一个繁琐的过程。

方法是使用 helm 这样的包管理器来打包所有的 Kubernetes 清单，它允许您使用 Helm 图表来定义、安装和升级应用程序。当您使用 Helm 进行部署时，您可以在一个地方定义所有这些资源，这使得跨环境一致地部署您的应用程序变得更加容易。

本文将向您介绍 Helm，这是一个 CNCF 研究生项目，并向您展示如何使用 Harness 将 Helm 应用程序部署到您的 Kubernetes 集群。此外，您还将学习如何嵌入容错，以便每次出现错误时，平台都会将更改回滚到之前的稳定版本。

## 关于头盔

Helm 是 Kubernetes 的一个包管理器，允许您在 Kubernetes 集群上轻松安装和管理应用程序。您可以使用 Helm 为您的 Kubernetes 集群查找、安装和升级其他人上传的软件。该项目还可以通过你制作的图表帮助你与他人分享你的软件。

Deis(现在是微软的一部分)在 2016 年推出了 Helm 项目，作为在 Kubernetes 上打包和部署应用程序的一种方式。Helm 受到了 apt 和 Homebrew 等软件包管理公司的影响,“Helm”一词源自希腊语，意为“舵手”或“领航员”

Helm 现在是云原生计算基金会(CNCF)的一个项目，Helm 3 于 2019 年发布，是最新的主要版本。

## 头盔的好处

Kubernetes 软件包管理器带来了许多好处，包括:

1.Helm 是一个功能强大且易于使用的工具，可以帮助您管理 Kubernetes 应用程序，并借助图表进行共享。

2.该项目使得在 Kubernetes 上用简单的命令部署、删除和管理应用程序变得容易。

3.它帮助您从单一控制台高效管理 Kubernetes 资源。

4.借助健壮的版本控制，可以很容易地回滚对 Kubernetes 应用程序的更改。

5.这是一个开源项目，由社区积极维护，因此故障排除问题变得更加容易，您可以根据自己的需求提交补丁。

## 入门指南

对于任何项目，你都需要有一些先决条件，所以同样在这篇文章中，你需要有:

1.  kubectl 的工作知识
2.  基本了解[舵图，Values.yaml](https://helm.sh/docs/topics/charts/)
3.  访问云集群或[本地集群](https://minikube.sigs.k8s.io/docs/start/)
4.  GitHub 帐户派生存储库并更新图表
5.  你可以在这里注册一个免费的线束账户
6.  浏览了[线束入门博客](https://docs.google.com/document/d/1Z6srB0dDsi6_xitibaPWJPH4-PEBM2MdVn6saTHEAWU/edit?usp=sharing)
7.  运行一个 Kubernetes 集群，[设置代理](https://docs.google.com/document/d/12jRJiwZ2jbtrrBqRykokpc2ai-ZN0OEqqNcrYrsHwy4/edit?usp=sharing)。

## 高级步骤

1.  设置您的帐户
2.  创建项目
3.  创建管道
4.  创建服务
5.  创造环境
6.  创建执行阶段
7.  运行管道

## 项目设置

请按照以下步骤开始:

1.  注册免费试用安全带
2.  选择 TryNextGen 选项卡获得无缝体验。
3.  创建一个新项目并选择连续交付模块。

‍

4.  开始创建新的管道，并按照下面的步骤添加细节。

‍

‍

## 服务

开始创建管道后，您需要做的第一件事是创建服务。

‍

现在根据下面的内容设置您的服务和清单，并确保您的连接器就位。

‍

对于清单，派生并使用下面的 [GitHub 库](https://github.com/harness-apps/helm-example/)作为您的位置，并选择清单类型作为舵图。分叉很重要，因为在本教程的横向阶段，你需要编辑你的值。

‍

### 图表结构

该存储库包含一个包含您的图表的 harness-helm/文件夹。如果你打开这个文件夹，这个结构包含以下内容:
1。模板/ -包含所有对象清单

2.Chart.yaml -一个包含 h\Helm 详细信息的文件

3.Values.yaml -包含默认配置的文件

‍

现在，要从存储库中列出您的清单详细信息，请按照下图填充以下内容:

Values.yaml 是一个文件，它为您提供了一个窗格来编辑所有默认值，而无需深入清单！您可以编辑的其他参数包括:

1.  清单名称-为您添加一个名称以引用您的清单
2.  Git 提取类型——定义如何提取图表
3.  分支-定义您的图表位于哪个分支
4.  图表路径-这是您的图表的根目录
5.  头盔版本-这是头盔的版本，在本教程中，你使用头盔 V3
6.  Values.yaml -添加将覆盖默认值的文件

接下来指定您的环境，如果您愿意，可以使用代理或主 URL 方法连接到它！

## 执行阶段

在您的环境准备就绪并且集群连接之后，添加您的步骤。由于头盔是本教程的中心，你将使用头盔部署。

还有许多其他策略，如滚动部署、canary、blue green 或其他策略，您可以根据自己的需求来使用。

‍

单击添加步骤，然后您应该会看到以下内容:

选择头盔部署！

添加参数并应用更改，使用右上角的蓝色按钮保存您的管道！

‍

## 运行管道

单击 Run 启动您的管道，并等待看到您的工件被部署到您的集群上。

‍

如果您正确完成了这些步骤，您应该会收到如下绿色复选标记:

‍

如果您在公共云集群上，存储库应该使用 LoadBalancer 服务公开一个端点，您可以使用命令“kubectl get svc”找到该端点，并通过外部 IP 进行访问:

## 结论

我希望这篇文章有助于你理解 Helm 如何在 Harness 上工作，以及它如何简化你的工作流程。在本系列中，您将了解如何在 Harness 中轻松实现 Helm 的容错功能，以保护您的工作流免受故障影响，并在必要时调用回滚功能。

在那之前，不要忘记[请求您的个性化安全带演示](https://harness.io/demo/)，[下载免费试用](https://app.harness.io/auth/#/signup/?module=cd)或者如果您正面临一些问题，请加入[我们的社区 slack 频道，让您的疑问得到解答！](https://join.slack.com/t/harnesscommunity/shared_invite/zt-1fpgkrr4j-0fEENRq7Ekg8ytD7Sz3WsQ)

‍