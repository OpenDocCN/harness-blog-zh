# CI/CD 管线的管线模式|线束

> 原文：<https://www.harness.io/blog/deployment-pipeline-patterns>

在我们的 CI/CD 管道模式电子书中，我们描述了 CI 和 CD 流程中最常见的管道模式。

持续集成/持续交付渠道对于将您的想法投入生产至关重要。在您的管道中可能有很多东西需要解开，因为它们可以模仿您的[软件开发生命周期【SDLC】](https://harness.io/blog/devops/software-development-life-cycle/)，并且包括对您的组织和行业来说谨慎的意见或治理。在 Harness，我们有幸看到数百个不同组织在软件交付过程中围绕管道策略和自动化的方法。在我们的 [CI/CD 管道模式电子书](https://harness.io/ebook-pipeline-patterns/)中，我们描述了 CI 和 CD 流程中最常见的管道模式。

## 什么是管道？

管道通常由一个或多个步骤组成，在这些步骤中，源代码被转换为一个构建，该构建在一个或多个环境中进行测试和部署，直到最终到达生产中的最终用户。管道可以包含配置和基础设施代码，并且是部署过程的核心管道。

### 为什么要使用管道？

随着系统变得越来越复杂、分布式和模块化，我们的期望是系统将一直运行并可用。拥有一种安全、快速、可重复的方式将您的变更投入生产是至关重要的。不幸的是，脚本站不住脚，或者需要修改和执行几十到几百次，因为软件开发是一个迭代的练习，并且需要将您的工件部署到不止一个地方。

### 好管道和坏管道的区别

简单地说，好的管道和管道执行是快速的和可重复的，伟大的管道是快速的、安全的和可重复的。《加速》一书指出，对于生产部署，精英执行者的交付周期不到 1 小时，变更失败率不到 15%。因此，一个好的部署管道将在一个小时内完成，并在代码到达最终用户之前捕获 95%的异常和回归。如果您的代码需要一个多小时才能到达生产环境，或者如果 10 个部署中有 2 个以上失败，您可能需要重新考虑您的管道设计和策略。

### 如何选择具体的管道策略

管道的策略和结构倾向于遵循其主要驱动因素或触发因素。管线的驱动目标对管线遵循的结构和模式有影响。管道可以由环境、测试、服务、结果和/或人来驱动。例如，对于一个非常分布式的应用程序，让应用程序进入多个环境可能是关键的驱动因素，管道是非常以部署为中心的，典型的触发器是一个可部署的工件。如果您的组织有大量的手动批准，人员可能是驱动因素。在电子书中，我们将详细介绍这些驱动因素。

## 管道设计模式

管道可以像组织一样独特；尽管随着行业向发布的标准化迈进，模式开始出现。下面是电子书中概述的模式的子集，并且是平台不可知的。根据目标和反馈循环，管道的最终环境可能不是生产环境。

### 按钮按压模式

在开始管道之旅时有一个双重性:要么管道是完全自动化的，要么是完全手动的。按钮按压模式允许在终点线处的人的认可，而不是完全去除人的因素。这种方法允许在部署/连续部署之前，出于合规性、法规或建立信任的原因，再进行一次验证。

### 测试自动化模式

测试自动化可以有自己的生命。现代测试框架模仿应用程序开发，它有编排需求和要与应用程序本身一起部署的包。修改测试覆盖率以覆盖应用程序/api 的变化是自动化测试的一个期望。拥有一个专用于测试自动化的管道可能是一个谨慎的选择。

### 完全认可模式

还记得你小时候玩电话吗？你可以在人与人之间传递一个秘密信息，考虑到对短语的影响，看看在开始时的原始信息在结尾时有多大的不同。这可能是你管道中的一个模式。在完全批准模式下，大多数(如果不是全部)升级步骤都需要手动批准。

在这本电子书中，我们讨论了不同模式的优缺点，对每种模式进行了评分，并讨论了受益于每种模式的相关行业。

## 下载管道模式电子书

拿起你的[管道模式电子书](https://harness.io/ebook-pipeline-patterns/)，深入探究我们观察到的模式。根据是否允许停机，部署模式暗示了交付过程中不同的安全级别。如果你有兴趣了解更多，一个值得参观的地方是 [Harness 社区](https://community.harness.io/)，在那里你可以与每天解决 CI/CD 问题和移动 DevOps 针的人们互动。在 Harness，我们很高兴分享我们有幸参与的许多旅程中所学到的东西。