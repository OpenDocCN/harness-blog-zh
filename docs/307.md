# 对 CI/CD |装具的吉拉票务支持

> 原文：<https://www.harness.io/blog/atlassian-jira-ticketing-support>

如何使用带线束的 CI/CD 的 Atlassian 吉拉票务支持。跟踪管道进度，批准使用吉拉管道。

2018 年，Harness 为我们的客户提供了 24 个主要的平台集成，从微软 Azure 到 HashiCorp Terraform 再到 Datadog。今天，我们有超过 40 种不同的集成，可以跨您的应用、云、技术堆栈和工具实现端到端的连续交付。

2018 年请求最多的集成之一是吉拉票务支持。亚特兰蒂斯吉拉公司为客户(尤其是开发团队)提供贯穿其软件交付生命周期的项目和问题跟踪。因此，与[线束连续交付](https://harness.io/products/continuous-delivery/)的集成是“不需要动脑筋的”

我们的客户要求能够做两件简单的事情。跟踪在吉拉部署管道的进度。
2。使用吉拉批准/拒绝部署管道阶段或工作流。

因此，我很高兴(也很欣慰)地宣布，这两个用例现在都可以使用了。

经过上周的整合，它实际上相当光滑，易于安装。

## 将吉拉与马具整合在一起

将吉拉与 Harness 集成在一起不到一分钟。
要开始，进入**设置>连接器**并点击**添加协作提供商**

接下来，从类型下拉列表中选择**吉拉**，提供一个实例**名称，**，并为您希望添加的吉拉实例提供 **URL、用户名**和**密码【T8:** 

最后，点击**测试**按钮来验证你的吉拉连接。完成后，您的吉拉集成将如下所示:

**注意:**如果需要，您可以添加/管理多个吉拉实例。

## 使用吉拉跟踪管道进度

Harness 现在使您能够在执行管道、阶段或部署工作流期间，根据需要多次创建或更新吉拉票证。

例如，让我们在 Harness 中编辑一个现有的部署工作流，以便在部署工作流执行开始时创建一个吉拉票证，并在该工作流成功完成时更新同一个吉拉票证。

为此，让我们**打开**并**编辑一个现有的部署工作流** :

要创建我们的吉拉票证，让我们单击**预部署步骤**对话框下的**添加步骤**。

Harness 现在为我们提供了一个可以添加的命令列表。你可以看到**吉拉**已经作为一个新的**协作**命令被添加，所以让我们选择它。

到**创建吉拉车票**，我们简单配置**预部署步骤**如下:

注意，我们可以使用线束变量(使用$ pre-fix)来用工作流、工件和管道上下文填充吉拉票据。

我们还可以从输出中创建一个名为“吉拉”的新变量，这样我们就可以在我们的工作流中再次引用同一个吉拉票证，如果我们想要进行更新的话。

为了**更新相同的吉拉票证**，我们可以在部署工作流中配置一个**部署后步骤**，如下所示:

注意，我们使用变量 **${Jira.issueId}** 作为键来引用我们在**预部署步骤**中创建的同一个吉拉票证。这意味着我们可以将活动增量添加到同一个吉拉票证，而无需记住票证 id 或标识符。

现在，当我们下一次运行我们的部署工作流时，我们看到我们的吉拉步骤完全可视化(截图如下)。请注意我们刚刚在屏幕截图的右下角创建的吉拉机票的深层链接:

点击上面部署工作流中显示的深层链接，我们将直接进入吉拉票证，显示我们在部署前和部署后步骤中记录的所有活动:

这样你就有了:在一张吉拉票据中对你的部署管道进行全面的进度跟踪！

但是等等...还有呢！

## 使用吉拉票证批准管道

到目前为止，我们的客户只能使用我们的 Harness UI 中闪亮的大按钮来批准/拒绝管道阶段或工作流执行:

如今，客户只需更新预定义的吉拉机票属性的值，就可以在一张吉拉机票内完成所有这些工作。

例如，将吉拉票证的**状态属性**更改为“已部署”或“已批准”可以自动批准管道阶段或部署工作流的执行。

同样，这实际上需要几分钟的时间来配置，您就可以开始了。

## 为管道阶段添加吉拉批准

假设我们有一个简单的三阶段部署管道，包括开发、QA 和生产。

现在让我们想象我们想要一个新的吉拉批准阶段来管理代码如何从 QA 提升到生产。

点击 QA 和生产阶段之间的 **+** 符号。现在，让我们定义我们的吉拉审批标准应该是什么样的:

选择您希望使用的**吉拉实例**和**项目**，然后为工单上下文设置**键/问题 id** 。
最后，定义将批准/拒绝您的管道阶段的标签**属性/值标准**。

在上例中，将标签**状态**更改为**完成**将批准流水线阶段，将标签**状态**更改为**待完成**将拒绝流水线阶段。

一旦我们的吉拉批准配置完毕，我们的渠道现在有 4 个阶段:

## 为部署工作流执行添加吉拉审批

让我们回到我们最初的部署工作流，我们为其添加了吉拉票证更新:

我们实际上可以将吉拉审批添加到此工作流程的任何部分。

让我们在我们的**预部署“创建吉拉票”步骤:**
之后增加一个**新吉拉审批步骤**

我们可以通过从**其他**列表中选择一个**批准**命令来完成此操作:

就像我们对管道阶段吉拉批准所做的那样，我们简单地为我们的工作流执行定义批准标准:

现在，当我们运行我们的部署工作流时，执行将一直等到有人在吉拉批准票据。

这可以通过将吉拉票证**状态**属性更新为**完成**来完成。这样做将导致部署工作流继续:

我们走吧。只需几分钟，您就可以将吉拉配置为批准您的管道阶段或部署工作流执行。鲍勃是你的叔叔。

## 接下来会发生什么？

几周后，我们将扩展吉拉支持，允许为以下活动创建吉拉门票:

*   部署验证失败(例如，新的性能或质量回归)
*   [全天候服务保护](https://harness.io/blog/harness-24-7-service-guard/)故障(例如性能/可用性)
*   回滚

例如，开发人员可能会将新的微服务部署到生产中，而我们的持续验证可能会在不久后发现新的性能异常，需要使用吉拉票证来捕获、管理和采取行动。这最终为开发人员提供了一个闭环反馈。

我们也将很快实现相同的 ServiceNow 集成！

想试试马具吗？你还有两分钟就要开始我们的审判了。

干杯，
史蒂夫。@ BurtonSays 说