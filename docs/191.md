# 比尔休克！寻求持续的云成本效益|利用

> 原文：<https://www.harness.io/blog/continuous-efficiency-capabilities>

账单休克是开始管理云成本的最常见的紧迫事件。通过持续提高云成本的效率，在不减缓创新的情况下平衡成本。

即使对专家来说，云成本也是一个现实问题。如果连 AWS 的首席传播者都可以在他的云资源上犯错误，为什么我们不能呢？这实际上是我在谈到云成本管理时反复遇到的最引人注目的事件的一个完美例子:**比尔震惊！**😱

## 云消费的现实

在云上花钱很容易。寻找花钱的方式很难。最简单的不花钱的方法就是什么都不做，但这违背了创新或做生意的目的。但有时，这是控制疯狂支出的唯一方法，或者更有可能是超出预算的超支。事实上，我从一家上市公司的首席技术官那里听说，当他们还是一家初创公司时，他们的云成本急剧膨胀，以至于他不得不阻止他的工程团队使用云资源，并且他不得不制定一个流程，其中他不得不*手动批准每个云资源请求*。谈论预算紧缩。

作为一群关心此事的公民，我们共同发现，要正确进行成本管理，我们需要解决三个用例:

1.  成本可见性，或了解成本的来源
2.  节约成本，或者想办法少花钱
3.  成本预测，或预测未来的成本

当然，其中每一个都有更多的细微差别，但我的观点是，我们已经将云成本管理的整体问题分解为各个组成部分，并且我们在解决这些问题方面做得非常好。外面有太多的工具，许多都在构建自己的解决方案来满足他们的特定需求。

与此同时，云成本管理是一个相对较新的学科，我们仍在学习实现它的最佳方法。除了云成本管理的多种模式和[方法之外，我们还在努力寻找在解决核心用例时变得更加高效的方法。随着所有这些进展，我们最终将集体转向需要最少人工干预的成本管理模式，转而转向具有人工护栏的主要放手功能。也许有一天，我们甚至会有足够强大的人工智能来接管整个事情！那时我们将真正拥有持续的成本效益。](https://harness.io/blog/cloud-cost-management-methods/)

## 什么是持续成本效率？

为了简单起见(因为“成本”在这里是隐含的)，在本文中，我将“持续的成本效率”简称为“持续的效率”。它也更容易从舌头上滚下来。

持续的效率是团队的黄金标准，他们希望在不减缓创新的情况下平衡成本。

从表面上看，云成本管理的持续效率正如其听起来的那样:始终保持成本效率。如今，许多组织采用时间点优化的方法，这意味着他们有一个稳定的节奏来审查成本并采取相应措施。大多数情况下，这是每月或每季度一次。我们可以称之为“离散的”效率，而不是连续的，用数学术语来说。简单地说，离散意味着“时间点”，而连续意味着“所有时间”

*Discrete versus continuous visualized on a graph*.

我认为，为了实现真正持续的效率，我们需要完全的机器接管我们的云基础设施，因为人类根本无法跟上需要处理以做出效率决策的信息量。这就是为什么今天许多组织每隔几个月才进行这些效率练习。

要做哪怕是一个时间点的效率练习，你都必须做到以下几点:

*   拍摄某个时间点的基础架构成本快照
*   了解成本的来源
*   确定哪些成本会因为使用或增长模式而持续存在
*   确定是否有可以消除的成本
*   与工程部确认成本削减目标不会破坏任何东西
*   实施基础设施变革以降低成本
*   除了现有的容量需求之外，还要规划未来的容量需求
*   与云提供商协商获得批量折扣
*   实施治理以确保那些打折的资源得到使用
*   我肯定有我错过的东西…

你看到这种模式如何扰乱正常的创新过程了吗？不仅要花时间了解成本，而且团队还必须花时间重做部分基础设施以提高成本效益。这样，我们就平衡了成本，但却以创新为代价。

## 跳过线:可操作的见解

云成本管理解决方案解决了这些成本管理实践带来的每一个问题，但是当一个问题得到解决时，它只会引发另一个问题。例如，第一个成本可见性问题是很难可视化成本。之后，需要按服务或产品分解成本，并能够以每种资源的粒度查看成本。现在，一个大的可见性问题是，资源需要与预算所有者、团队或开发人员相关联，以便可以准确地进行按存储容量使用计费和按存储容量使用显示，从而帮助保持团队的责任心。

你可能会注意到这里的一个趋势:解决方案开始有点笼统，随着时间的推移变得更加具体。这也不仅仅是对成本的看法。随着这些需求变得越来越复杂，参与的人数也越来越多。在高层次上，财务团队需要能够可视化成本。然后，工程预算负责人被拉进来。现在，甚至开发人员也被拉了进来，这使得实现财务可见性所需的利益相关者的数量呈指数级增长。随着人数和数据量的增加，理解成本的时间因素也随之增加。这反过来又使得找到好的见解变得困难，而找到将这些见解付诸行动的方法变得更加困难。

随着这些问题的出现，云成本管理解决方案需要简化。输入术语“可操作的见解”

*Less work for the same (or better) result? I’d be happy, too*.

随着云成本管理的发展，我们看到人们越来越关注减少实际人员发现问题所需的时间，以便他们可以花时间解决问题。有时这被称为提供“可操作的见解”，这是第一代云成本管理工具无法做到的。通常，你必须将所有的信息可视化，并产生自己的见解。今天的工具努力采取提供这些可操作的见解的心态，这样人类就不用花时间破译数据了。相反，他们正在行动，如果他们需要仔细研究数据，他们当然可以，因为这种能力是固有的！

最明显的例子是成本节约建议功能，基本上每个云成本管理工具都提供这一功能。现代工具不是让团队仔细研究数据并找到他们自己的节约，而是帮助团队看到缩小规模、调整规模和购买折扣容量的机会。此外，这些建议通常——也应该——包括建议背后的数据，以显示历史使用模式。

这就是有趣的地方。您可能会认为，既然这些可行的见解唾手可得，您就可以立即采取行动，实现所显示的节约。在理想的世界里，你是对的——但在现实中，事情要比这复杂得多。要实现您发现的节约，首先需要对它们进行验证，而且，您猜对了，它们必须由首先参与查找和理解所有成本数据的同一大群人进行验证。

出现这种情况的原因是，这些人是预算所有者，更重要的是，他们和他们的团队了解一切是如何工作的，以及基础架构的变化(如缩减计算实例以节省资金)实际上会对应用程序产生什么影响。这是至关重要的，但同时它也减缓了我们对持续效率的追求。

## 在这里和那里之间:问题

让我们先喘口气。我们知道，可行的见解来自于对更简单的成本管理流程的需求，我们仍然会遇到与以前相同的问题:如果从工程角度来看，成本优化机会没有意义，那么它们就没有意义。

看起来我们需要修改之前的流程，增加一个步骤。然后，让我们探索如何简化这一点。

*Are the potential savings for real?*

让我们看看是什么减缓了从可行的见解或任何成本节约行动计划到实际实施的过程:

*   有各种各样的团队参与所有的成本，而且他们都有不同的优先事项。他们都需要:对成本有共同的理解；就他们希望通过成本管理实现的目标达成一致；验证潜在的节约，并承认它们是真实的；创建一个关于如何节约的计划。
*   **负责产生成本的工程团队通常不会对成本进行优先排序。**工程部门(通常是应用程序开发部门)优先考虑最终用户的性能，成本自然不会考虑在内。当他们看到成本节约建议时，他们需要验证这些建议不会对性能产生影响。
*   **改变基础设施总是有风险的。**正如单个应用程序开发工程团队需要验证性能一样，拥有云基础架构的团队也必须确保基础架构的变化不会造成破坏。由于基础架构支持多种应用程序，并严重影响性能和用户体验，因此进行这种验证至关重要。
*   **云资源变化如此频繁，以至于很难足够快地掌握它们以持续优化。**这是云成本管理通常是一个时间点操作的一个重要原因，旨在在比单个资源更高的级别进行优化，即使这可能是最大的节约所在。您必须对您的基础架构进行快照，并在此基础上进行优化，将潜在的重大机会留在桌面上。通常必须猜测该快照在未来会是什么样子，甚至可能需要几天或几周的时间来解决节省建议。

所有这些问题都需要时间来解决，导致成本建议在实施时往往已经过时——毫无用处！我们观察到，我们需要进行的至关重要的验证实际上减少了我们可以实现的节约。雪上加霜的是，提供的许多成本节约建议被认为是不真实的，因为它们没有通过某种形式的验证，这让负责云成本管理的团队感到沮丧，并为云成本管理解决方案带来了如何解决这一问题的巨大问题。

## 我们不仅带来问题，还带来解决方案

我意识到我刚刚给你丢了几个问题炸弹，但是不要担心——每个问题都有解决方案。那么，解决这些问题的正确方法是什么呢？当然，这里有很多工具，我将向你推荐一个？也许吧，但不是你想的那样。

更重要的是，一个解决方案*看起来*像什么？让我们做一些构思。

### 问题 1:许多利益相关者

马上，我们可以考虑删除利益相关者。但是相关人员已经是最基本的利益相关者，他们需要被咨询。知道它们是必需的之后，我想到了另外两种可能性:

1.  简化利益相关方之间的流程和工作流，以提高决策速度
2.  尽早并经常让利益相关者参与进来，授权他们自己控制成本，因为他们毕竟是专家

如果我们能够简化组织让利益相关者参与决策的方式，我们就离持续优化成本更近了一步。

### 问题 2:成本不是工程优先考虑的问题

我在云成本管理中听到的最普遍的说法是，如今，工程团队并没有将成本作为优先事项，但他们的任务是临时寻找和管理成本。这给工程师带来了挫败感，因为这可能是一次长途跋涉；这项工作偏离了他们的核心，即运输质量和性能代码。此外，这还让云成本管理利益相关方感到沮丧，因为他们没有意识到他们知道的节约。文化就是不存在。

解决这个问题的一个办法是[转移](https://harness.io/learn/ebooks/ebook-cost-management-kubernetes/)云成本管理，尽管这意味着让工程团队多了一件担心的事情。如果我们想做好这件事，有三件事要考虑。

1.  让工程师更容易追踪成本，这样他们就不必花费数小时或数天来寻找成本
2.  简化他们发现、验证和实施成本节约的流程，以便最大限度地减少劳动和时间投入
3.  为他们提供降低成本的自动化方法

随着工程师们自己武装到牙齿来管理成本，我们突然在组织的另一个层面上进行优化。在这一点上，我们已经使它变得容易:需要管理成本的人；需要验证节约机会的预算负责人和团队领导；以及最终需要实现它们的工程师。我们在不断提高效率的道路上走得很好，但还有更多的问题需要考虑。

### 问题 3:基础设施风险

我们不想为了节省成本而把事情弄糟。归根结底，一个企业不是从省钱中成长起来的，而是从满意的付费客户中成长起来的。虽然我们希望优化我们的支出，但不能以牺牲应用性能和用户体验为代价，这就是为什么我们确保建议基础架构变更的成本节约建议经过严格审核。

这可能需要很长时间，并且会使许多大的成本节约建议无效，那么我们如何解决这个问题呢？以下是一些想法:

1.  建议小的改变，而不是大的改变。这是降低风险的经典方法，更容易信任和尝试。谁知道呢，做一堆这样的事情甚至可以防止推荐过时，从而实现更多的节省。例如，建议更改一堆 Kubernetes 资源的请求和限制，然后优化集群或节点，比立即缩减整个集群或计算实例群的风险要小。
2.  **创造“一劳永逸”的解决方案。**我们可以寻找更简单的解决方案，他们只需要做一次，就可以“覆盖”更长的时间，而不是要求团队不断地重新寻找优化机会。一些简单的例子是设置资源配额和实现资源调度。
3.  **安全地将事情自动化。**同样，我们可以让工程师优化他们自己的成本，如果他们和基础设施团队不那么担心会怎么样？例如，如果我们可以将资源调度提升到一个新的水平，并自动停止闲置资源，这样它们就不会产生成本，会怎么样？通过这种方式，成本在微观层面得到了优化，并最大限度地减少了预算所有者和云成本经理的担忧。它还减少了基础设施和工程团队的工作量。

这里出现了一个主题——在我们的优化工作变得更加微观的同时减少工作量。这与云成本管理工具的起点相去甚远，后者只是可视化成本。在这一点上，看起来持续的效率要求集成到基础架构的日常工作中。我们稍后再来讨论这个问题。

### 问题 4:云资源变化快

实现持续效率的最大挑战可能是云资源的加速和终止速度。顺便说一下，这也是为什么浪费越积越多，治理越来越难的原因，但这是另一个话题了。

如果[云成本优化](https://harness.io/blog/cloud-cost-optimization/)需要时间点或快照视图，那么改变云资源意味着持续的效率需要在无限定义的时间段内对重复的快照进行分析和操作。这就是我们如何从[离散到连续](https://www.khanacademy.org/math/ap-calculus-ab/ab-integration-new/ab-6-3/a/definite-integral-as-the-limit-of-a-riemann-sum)——我基本上是在描述微积分！

Cloud cost management is calculus?!

整个概念是在微积分和连续效率方面变得更加微观。我们希望始终保持成本优化，而不是着眼于时间点的成本并寻找点优化。

事实证明，这正是我们一直努力的方向！通过授权组织的所有级别来了解和优化成本，我们已经变得更加微观，从而更接近持续的效率。

快速改变云成本的解决方案是保持对所有资源的掌控，这实际上只有以我们已经做到的方式，通过赋予每个人权力才是可能的。我们已经成功地创建了持续高效的机制，但是我们仍然缺少一个部分。

## 用自动化杀死比尔休克

尽管我们已经让每个人都能够发现和管理成本，但始终保持对成本的掌控仍然要求很高。毕竟，成本并不是每个人的头等大事。最终发生的情况是，整个组织中的人们将零星地做事情，将会有更少的账单冲击，并且实际上在时间点练习中将会出现更少的大量节约机会，因为我们现在更有效率了。然而，我们可以做得更好。

如果我们能够自动化部分新工作负载，使我们不完全依赖于零星的检查，那么我们会突然做得更好。我们可以从基本的自动化开始，例如警报集成到 Slack、团队或电子邮件等工作流工具中，这非常有帮助！我们可以让人们只在需要人干预的时候才担心事情，而不是一直都要检查。

人类干预也是另一个机会。警报本质上告诉我们，当事情朝着错误的方向发展时，我们需要注意，但这只能创造一种类型的成本效益。我们还可以自动化那些进展顺利的事情，并提高这些事情的成本效益。如果我们可以在更便宜的云资源上运行相同的工作负载，为什么不呢，尤其是如果它可以自动化的话？此外，我们能否自动检测资源浪费，例如，当它们闲置时，并阻止它们，这样我们就不用为它们付费了？

这就是我们想要创造的那种微观效率。我们已经成功地从如何获得更好的折扣的自上而下的观点，一直到如何首先从浪费开始停止花费这么多的本质。我认为，这是我们目前在云成本方面的持续效率。

1.  根据历史使用量和预计的未来使用量，为高级优化提供深入的可见性和数据支持的建议
2.  授权各级团队获得相同的可见性和节约能力，但在与个人所有者相关的上下文中
3.  创建集成到日常基础设施中的自动化，以减轻工作负担，包括需要关注的事情，以及无需人工干预就能提高效率的事情

## 持续高效所需的能力

现在我们知道了什么是组织中的持续效率，让我们来看看它在解决方案中应该是什么样子。产品特性，如果你愿意的话。

**有什么特点？它让你做什么？你从中得到了什么？**应用环境&可见性按应用或其他环境查看资源使用情况管理云成本更像管理性能云事件关联将配置更改和部署与成本变化相关联准确了解发生了什么改变了您的成本异常检测在异常成本模式滚雪球式增长之前发现它们避免每月账单中的成本惊喜根本成本分析找到确切的变化或改变成本的资源节省时间寻找成本变化的资源每小时时间粒度查看成本变化 提早发生并经常洞察工程变更的影响集群&非集群成本查看所有成本， 无论是针对云还是容器，查看所有基础架构的资源使用情况多种云支持查看成本无论是哪种云组合，查看所有云提供商的支出整合视图建议利用背后的数据发现节约机会在最少的时间内获得最大的节约角度创建成本上下文并使其与消费者直接相关相关成本信息而不是挖掘警报&预算制定预算并跟踪进度确保不会浪费 您的预算太快数据 API 将数据提取出来用于其他位置或软件切片和切片数据对您来说最有意义预测根据历史模式预测成本将在哪里更好地进行容量规划和更轻松地设置预算组织映射将成本映射到资源的确切所有者通过准确的按存储容量使用计费和按存储容量使用显示来推动问责制自动最大限度地减少浪费自动提高资源使用效率节省资金，而您却在闲置资源上睡觉假设分析比较资源规划的成本与性能在成本和性能之间做出更明智的权衡

还记得我说过云成本管理解决方案似乎需要集成到日常基础架构中吗？这就是它发挥作用的地方。解决方案不仅需要在任何给定时间提供上下文相关的可见性，还需要充分了解使用情况，以实现节约而不是潜在节约。有了可以很好集成的解决方案，**输出不是推荐，而是成本节约。**

## 利用线束创造持续效率

我希望我能马上跳出来说[利用云成本管理](https://harness.io/products/cloud-cost/)将解决您所有的云成本管理问题。虽然它并不完美，但它会让你比大多数其他解决方案走得更远。你必须认识到，持续的效率永远不会只是一个工具性的东西——它需要组织文化和人员来实现。**持续的效率是希望在不减缓创新的情况下平衡成本的团队的黄金标准。**

为了推动真正的持续效率，你不能依赖单个团队或所有云成本的所有者来做所有的事情——如果你从这篇文章中走出来，认为它不需要跨多个团队的全场压力，我们就不是在说同一种语言。

虽然像[利用云成本管理](https://harness.io/products/cloud-cost/)这样的工具可以为讨论提供基础，并简化云成本管理中所需的大量工作，但仍然需要让合适的人参与进来，并根据预期进行培训，使用一种工具使这变得容易。

准备好进一步了解云成本了吗？阅读我们的 Kubernetes 电子书[成本管理策略。](https://harness.io/learn/ebooks/ebook-cost-management-kubernetes/)