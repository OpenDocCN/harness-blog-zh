# 有针对性的推广和发布进度|利用

> 原文：<https://www.harness.io/blog/targeted-rollouts-release-progression>

有针对性的推广:在大范围推广之前，向目标受众发布变更。了解它的好处以及你为什么想这么做。

当您想要尝试新的线束功能时，我们会通过功能标志为您启用它。我们的支持/客户团队会为您打开它。通常，对于新特性，我们的发布过程分多个阶段进行。首先，我们在较低的环境中进行内部测试。第二，我们在生产中进行内部测试。第三，我们在生产环境中对一些测试版客户进行了一段时间的测试，最终导致更大范围的发布。最后，对于某些功能，我们会发布更广泛的版本——但仍处于测试阶段，通常仍会对谁可以访问它们有一些限制。这是一个通过特性标志使用有针对性的展开的例子，然后随着您的学习和响应，逐步发布。我们将在这篇博客中深入探讨这个问题。

## 我为什么要这么做？

特性标志通常被认为是 CI/CD 的延续，这是有充分理由的。功能标志降低了部署的风险，使您可以更快地合并和发布，并减少对长期运行的功能分支的需求。通过这种方式，特征标志拉平了 CI/CD 的传统目标和成果。

然而，特性标志不仅仅是 CI/CD 的扩展。它们也是一个独立的过程，位于*CI/CD 旁边，支持新的行为或*从 CI/CD 循环中完全移除*那些行为。这简化了 CI/CD，还为您和您的客户提供了新的更好的发布选项。*

当以这种方式考虑特性标志时(作为一个与 CI/CD 并行的过程，而不是位于它之上的过程)，目标发布和发布进展是立即出现的高价值行为。

具体来说，有针对性的发布意味着首先为特定的受众群体打开您的变更，然后如果/当您准备好了，再将它推广到更多的用户。或者，为这个子集打开它，然后在有问题时立即关闭它。

像这样使用特性标志允许你强调测试变化，让项目经理或其他人驱动 alpha 和 beta 特性反馈，通过客户级别或区域控制发布，并与设计伙伴密切合作。所有这些都不需要依赖日常工程来完成部署/回滚周期。或者为目标用户启用/禁用某些东西。

## 它和金丝雀有什么不同？

我们之前写过[如何让旗帜和金丝雀](https://harness.io/blog/canaries-and-feature-flags/)一起工作，而不是非此即彼。但是在目标发布的背景下，重新审视特性标志和金丝雀之间的区别是值得的。

金丝雀是一种极好的方式来测试代码(T1)或工件(T3)的系统异常、性能问题、规模和其他类似的度量——并根据需要回滚。然而，特性标志可以帮助你*测试变化，而不仅仅是代码*。

具体来说，*测试变更而不仅仅是代码*意味着什么？这意味着代码按预期工作并不意味着功能对用户有效。它能满足我们客户的需求吗？他们能找到吗？他们能理解吗？他们有什么问题？

如果我们处于一个功能的测试阶段，并且我们正试图以最有用的顺序对下一批工作进行优先排序，那么让这种反馈来指导我们下一步做什么以及什么具有最大的影响是至关重要的。这不是关于“代码在技术上可行吗？”

这是一个例子，我们不希望将特性标志视为 CI/CD 的扩展，重点是简单地无风险地发布变更，而是作为我们软件开发过程的一个独立部分，在我们每天构建和部署时，我们不断地启用和禁用某些东西以获得反馈、学习和响应。

## 内部示例

我已经谈了一点我们如何在内部使用 Harness 特性标志，为我们的客户打开东西。这是我们在 Harness 使用有针对性的推广的一个例子。但是，这常常使 Slack 消息难以解析，因为有时我们使用线束特性标志来为线束特性标志客户打开线束特性标志内的一个特性(咻！).

不过，我们还有其他一些使用目标发布的好方法。

*   我们可能会对所有本地客户关闭某项功能，但不必担心维护更复杂的条件代码或单独的构建。

*   我们可以为我们的企业用户打开一些东西，而无需将其连接到实施计划限制的帐户框架，这让我们可以在流程的早期了解更多关于该功能的信息。

*   如果某项功能处于早期开发阶段，我们可能会有选择地向我们的销售工程团队提供访问权限，以便他们能够以实际操作的方式与合作伙伴客户一起演示该功能、获得反馈或围绕我们的发展方向展开对话。

这就是我们如何使用有针对性的推广。我们听说过很多其他团队在每个地区打开和关闭东西，以测试性能或规模。我们还听说过客户打开和关闭特定基础架构或集群的功能，以帮助迁移或获取有关可能配置的数据。你能做的很多事情并不是显而易见的。

## 结论

使用特性标志进行有针对性的部署是扩展您的组织如何构建软件、从客户那里学习以及消除变更风险的一种有效方式。

大多数组织在从特性标志开始时，都有这样的想法:特性标志需要“正确的”用例才能有用。他们常常不知道从哪里开始。然而，考虑有针对性的发布有助于解释默认情况下标志后面的东西越多，将来的选择就越多。

你不能总是预测什么，什么时候，在哪里，你会想要的目标。目标发布的思想是知道你有能力这样做，这样当场景、问题或需求出现时，你的组织能够学习和反应。

想继续阅读关于特性标志的内容吗？为什么不看看我们关于[断路开关](https://harness.io/blog/kill-switches/)和[的文章，如何开始使用功能标志](https://harness.io/blog/get-started-feature-flags/)？