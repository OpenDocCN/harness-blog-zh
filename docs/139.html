<html>
<head>
<title>Log4Shell Response | Harness</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>日志4外壳响应|线束</h1>
<blockquote>原文：<a href="https://www.harness.io/blog/log4shell-response#0001-01-01">https://www.harness.io/blog/log4shell-response#0001-01-01</a></blockquote><div><p>Harness对最近log4shell漏洞的回应。了解我们如何补救这种情况并确保您的安全。</p><div fs-richtext-element="rich-text" class="blog-rtf w-richtext"><p>2021年12月9日，安全研究人员在Java日志库<em> log4j </em>中公布了一个为期0天的漏洞，该漏洞通过记录特定字符串导致远程代码执行(RCE)。该漏洞适用于版本2.0 &lt; = log4j &lt; = 2.14.1，并在常见软件应用程序中广泛使用。</p><p>CVE-2021-44228，被称为<em> Log4Shell </em>，可能允许攻击者控制日志消息或日志消息参数，并在启用消息查找替换时执行任意代码。我们一了解到这个漏洞，Harness就开始了大范围的发现工作，以识别和验证log4j在我们的代码库中的存在。</p><h2>补救工作</h2><p>Harness的事故响应流程旨在快速通知相关利益相关方，并实现对运营或安全事件的快速响应。在这种情况下，我们的IR流程包括来自工程、安全、客户成功和法律部门的代表。</p><p>我们很快发现了log4j-api:2.12.1和log4j-to-slf4j:2.12.1支持我们的主要SaaS环境组件的几个实例。Harness使用这些库来收集和分类由我们的平台生成的各种消息。我们接下来的步骤是确定补救的优先级并触发我们的事件响应流程，首先是修补面向外部服务的漏洞。<br/> <br/> <a href="https://medium.com/harness-engineering/the-importance-of-knowing-your-customer-setup-4fe9b300df87" target="_blank"> Harness微服务部署</a>在谷歌云平台(GCP)的Kubernetes集群上完成。随着Harness的不断扩展，我们将微服务部署到GCP的多个Kubernetes集群，这些集群对客户数据进行水平分区，以确保我们的应用程序的性能。</p><p>我们还维护了一个API网关微服务，它作为一个反向代理，将客户请求路由到正确的集群。这个网关是我们打补丁的第一优先，我们能够成功地应用一个修补程序，而不会对性能或可用性产生任何影响。</p><p>不久之后，我们系统地将log4j 2.15.0补丁应用于我们三个生产k8s集群的后端服务。你可以在这篇博文的<a href="https://medium.com/harness-engineering/harness-deployment-architecture-a667fe359342" target="_blank">中了解更多关于我们的部署和生产架构的信息。</a></p><p>虽然Harness委托不支持HTTP/HTTPS终止(或运行任何嵌入式web服务),并且此漏洞不会对我们客户环境中的委托部署产生任何直接影响，但我们将很快用相同版本的库升级我们的委托。</p><h2>更新日期:2021年12月17日</h2><p>Harness知道<a href="https://nvd.nist.gov/vuln/detail/CVE-2021-45046" target="_blank"> CVE-2021-45056 </a>，这可能允许控制线程上下文映射的攻击者绕过log4j更新2.15.0中提供的缓解措施。阿帕奇<a href="https://logging.apache.org/log4j/2.x/security.html" target="_blank">将这个CVE </a>归类为低(3.7)。<br/> <br/> Apache已经推荐将log4j库额外升级到版本2.16.0。此更新目前正在我们的QA周期中，我们在12月22日星期三的标准主要版本将包括跨SaaS环境的<em> log4j 2.16.0 </em>和Harness delegate。<br/><br/>12月15日，Harness发布了我们的本地服务的更新版本(73021)，其中包含所有管理服务和委托中的log4j 2.16.0更新。客户可以通过正常机制获得更新的映像。</p><p>UTC时间12月17日，Harness向SaaS生产1和生产2实例发布了版本73119。在此版本中，SaaS的线束委托现在包括log4j版本2.15。</p><h2>更新日期:2021年12月20日</h2><p>12月17日，安全研究人员发现了2.15.0中引入的log4j缓解的旁路，如果被成功利用，将允许远程代码执行。</p><p>由于严重性和影响的增加，Harness立即在我们的生产环境中加快了log4j 2.16.0补丁的发布。截至12月18日，所有生产集群和网关服务都已成功修补到2.16.0。</p><p>12月18日，Apache发布了2.17.0，缓解了<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4104" target="_blank"> CVE-2021-4104 </a>(影响log4j 1.2)和<a href="https://logging.apache.org/log4j/2.x/security.html" target="_blank"> CVE-2021-45105 </a>(影响log4j-core JAR)。<br/> <br/>我们尚未检测到受影响组件在我们的环境中的使用。目前，CVE-2021-4104和CVE-2021-45105中确定的风险不适用。我们将继续评估新补丁的适用性，并监控Apache的安全页面是否有任何更新。</p></div></div>    
</body>
</html>