# RDS |线束自动停止简介

> 原文：<https://www.harness.io/blog/autostopping-for-rds>

利用智能云自动停止规则帮助管理闲置的云资源。今天，我们正在扩展自动停止功能，以包括对 RDS 的支持。

闲置资源是云账单的主要来源之一。EC2 实例、Kubernetes 工作负载和 RDS 等数据库等计算资源按运行的每分钟计费，而不管它们是否被主动使用。因此，在这些资源没有为任何流量服务的时候，它们只是增加了你的浪费。这种浪费性的支出增加了运营成本，却没有增加任何价值，并阻止您将这些资金投资于业务增长。生产前账户是此类成本的主要来源，其中资源大部分时间处于非活动状态，仅在开发人员部署或测试时使用。

这就是驾驭云成本管理将帮助你的地方。智能云自动停止是 Harness CCM 中的一项独特功能，可以在不改变基础架构的情况下回收浪费的预算。自动停止可以在没有检测到资源流量时停止[空闲资源](https://harness.io/blog/idle-resources/)，并在收到流量时自动启动。使用此功能的客户会在其生产前环境中看到大量节约！

向您的云帐户添加[自动停止规则](https://harness.io/blog/cloud-cost-management/autostopping-rules-kubernetes/)的主要好处是:

*   **自动节省:**自动停止可以在主要资源空闲时自动关闭主要资源和相关资源，从而最大限度地节省资源。例如:运行 web 服务器的 EC2 实例依赖于 RDS 数据库。
*   **减少开发人员的工作量**:无需维护和运行额外的脚本来启动/停止资源。
*   **最小化空闲资源的数量:**与最小资源计数为 1 的自动缩放不同，Harness AutoStopping 可以将最小资源减少到零，从而节省更多资源。

自动停止目前支持 EC2 实例、ECS 和 Kubernetes。在此次发布中，我们现在增加了对 RDS 自动停止的支持。

Amazon RDS 是最流行的托管数据库服务之一。促使我们优先支持 RDS 自动停止的趋势是:

*   RDS 数据库因其简单性和可伸缩性而被越来越多的人采用。
*   用于存储来自运行在 EC2/EKS/ECS、cron/批处理作业甚至无服务器功能上的 web 应用程序的数据。
*   RDS 成本可能会快速增长，即使数据库没有被频繁使用。

在下一节中，我们将介绍目前支持 RDS 自动停止的各种用例。

## **使用 RDS 的自动停止规则**

您可以使用 RDS 的自动停止功能创建三种规则。

**1-具有 RDS 依赖性的 EC2 规则**–这非常适合有 web 服务器或应用服务器连接到 RDS 数据库以访问/存储数据的用例。

在这种情况下，如果没有到应用服务器(EC2 实例)的流量，自动停止规则将停止应用服务器及其连接的 RDS 数据库。一旦应用服务器收到流量，规则将首先启动 RDS 实例，然后启动 EC2 实例。这为两种情况都节省了大量成本。

只需创建一个 EC2 自动停止规则并添加一个 RDS 规则作为依赖项，就可以实现这一点。

**2-仅 RDS 规则—**这适用于 RDS 数据库用于存储结果或直接从后台作业/Cron/批处理作业访问数据的用例。这些作业可以在 Lambda 函数、AWS 批处理或任何自定义 Cron 作业中运行。

在这种情况下，如果在预设的时间内没有检测到从后台作业到 RDS 数据库的流量，RDS 实例将被关闭。此外，一旦检测到数据库的流量，RDS 实例将自动启动。

**3- RDS 固定计划规则****–**这适用于 RDS 数据库需要运行一段固定时间的情况。当资源被配置为按照固定的计划运行或停止时，它不受该时间段内的活动或空闲的影响。例如:您可能需要数据库仅在每天上午 8 点到下午 5 点的办公时间内处于活动状态。

现在让我们看看如何通过 5 个简单的步骤来配置这些规则。

## **如何设置 RDS 的自动停止规则**

RDS 自动停止规则的设置过程非常简单。

1.  首先，选择要启用规则的 AWS 帐户。

2.  使用名称和空闲时间定义自动停止规则(如果未检测到流量，RDS 将在该时间后停止)。

3.  选择 RDS 实例，并从其中一个 AWS 区域添加数据库。

4.  (可选)添加对另一个规则的依赖关系或创建固定计划。

5.  单击下一步，检查并保存。就是这样！您正在节省大量成本。

## **结论**

专注于减少云支出和提高成本效率的努力会对组织的底线产生重大影响。这些节省下来的钱可以用来发展你的企业，并投入到生产中去。

自动化闲置资源管理是在云中实现成本节约的最简单方法之一。Harness CCM 使您开始成本优化之旅变得非常容易。自动停止可以通过动态和固定的计划来帮助优化您的生产前环境。[报名免费试用](https://harness.io/products/cloud-cost/)亲身体验！