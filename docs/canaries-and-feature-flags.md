# 渐进式交付:金丝雀和特色旗帜|装具

> 原文：<https://www.harness.io/blog/canaries-and-feature-flags>

在你的部署策略中使用金丝雀，在你的发布策略中使用特性标志是附加的——我们推荐这样做。

如果你熟悉使用现代 CD 工具，比如 Harness CD，你可能也熟悉 [canary releases](https://harness.io/blog/blue-green-canary-deployment-strategies/) 。Canaries 让你可以向总流量的一部分提供新版本的应用，了解它是如何工作的，然后以渐进的方式将更多的流量安全地转移到新版本。特性标志还允许你为你的用户子集打开某些东西，然后以一种安全和渐进的方式逐渐增加它！因此，作为一家销售带有金丝雀和功能标志的 CD 软件的公司，我们经常会问这样一个问题:有什么不同？

## 不是相对。还有。

我们总是说的第一件事是，这是一个很好的问题，可能需要几分钟来解开。第二，这不是特征旗对金丝雀，而是特征旗*和*金丝雀。

将 CD +功能标志视为一个阶梯，其中 CD 建立在 CI 之上，而功能标志建立在 CD 之上。在你的部署策略中使用金丝雀，在你的发布策略中使用特性标志是附加的——我们推荐这样做。

## 什么时候去金丝雀

金丝雀释放帮助你改变你的环境中的工件。它们确保新版本的应用程序安全运行，处理流量，并在您完全依赖它之前做您需要看到的指标。

Canaries 非常适合后端和以基础设施为中心的更改——甚至可以将您想要开始测试的特性放入 prod 中——每个部署都包含这些特性。金丝雀的目标总是让新版本达到 100%，理想情况下，尽可能快地完成。

然而，金丝雀并不意味着测试新功能、运行测试版程序，或者在你希望以精确的方式瞄准或必须坚持更长时间的变化周围切换。这就是特性标志的用武之地。

## 何时标记

特性标志在您的部署之后*被聚焦。功能标志允许您做两件主要的事情:*

*   以可控的方式为特定的受众子集(如位置、测试组或个人用户)打开更改或新功能。这非常适合 beta 测试，获得关于新特性的反馈，以及在没有部署和回滚的情况下测试变更的影响。
*   维护操作围绕着您可能希望偶尔打开或关闭的东西进行切换——比如在高峰时间关闭缓存。特性标志是一种更容易、更可见、更可审计的方式来实现这些类型的操作切换。

功能标志允许围绕您想要的任何维度进行精确、专门的定位——通过位置、计划、单个客户名称来定位您的用户——您能想到的任何您可能想要用于定位更改的内容。

Canary deployments take a deployment to production.

Feature flags “unbox” a deployment and bring features to specified customer subsets.

## 结论

使用 Canaries + Feature Flags，您可以推出您的部署，并验证新代码正在工作，产生良好的指标，而不是以渐进的方式制造混乱——此外，随着时间的推移，作为测试过程、试验过程或选择性功能启用需求的一部分，向目标用户或用户群推出功能和更改。

这为您提供了真正的渐进式交付，包括部署时和部署后的渐进式交付，完全控制您发布的内容、时间和对象。

如果你想了解更多关于功能标志的知识，我们写了一篇关于[它们是什么以及如何使用它们的文章](https://harness.io/blog/what-are-feature-flags/) -这是你 FF 之旅的一个很好的起点！