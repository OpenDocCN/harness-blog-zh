# 功能标志:它们是什么以及如何使用它们|线束

> 原文：<https://www.harness.io/blog/what-are-feature-flags>

什么是软件开发中的特征标志或特征切换？了解 Harness 如何支持这些为改进软件交付进行授权实验的计划。

构建软件是一个伟大的实验。很多时候我们被要求去做以前没有做过的事情；这是创新工作的核心。然而，许多迭代和试验往往发生在软件发布之前。从头开始构建一些东西，甚至中途跳到一个更老的项目，都需要大量的迭代。

对于许多软件工程师来说，一旦我们进行了部署，对现有特性的试验就会减少，并转向 [backlog](https://www.scrum.org/resources/what-is-a-product-backlog) 中的下一组特性。产品所有者/经理通常会收集反馈，以帮助确定下一组功能的优先级。从软件工程的角度来看，这可能感觉有点“先有鸡还是先有蛋”——如果没有实际部署的功能来获得反馈，我们如何知道我们是对的呢？

让我们用一个例子来说明这一点。客户要求更新他们仪表板的 UI 视图；他们想要能更快地呈现最相关信息的东西。既然产品团队已经收集了这些需求，那么就要靠工程来找出如何最好地构建它了。可能有一些潜在的解决方案:

1.  创建基于客户反馈的仪表板硬编码视图，并为每个客户创建该视图。
2.  允许客户通过拖放 UI 来决定他们想要的可视化效果，并给他们强大的过滤器来决定他们到底想要看什么。
3.  构建一个 ML 解决方案，了解客户更喜欢如何查看信息，然后自动对显示最相关信息的仪表板进行更改。

决定了一些潜在的解决方案后，现在就要由工程团队来决定实施这三个方案中的哪一个了。在客户看到它之前，他们必须从 3 个中选择 1 个，在接下来的几个冲刺阶段构建出 MVP，然后发货。这是他们第一次得到反馈，如果不是正确的解决方案，就必须重新构建！

现在，想象一下，如果这个新的特性周期能够为产品开发团队所改进。如果您在过去几年中一直关注开发人员工具，您可能会看到一个新的类别出现:特性标志。特性标志作为一个概念的诞生是为了提高开发速度和解决这个问题。

虽然特性标志作为托管工具的一个成熟类别是新的，但是特性标志以及它们所解决的问题已经存在了一段时间。让我们看看特性标志已经发展成什么样子，以及如何使用它们。

## 特征标志的故事

特性标志的核心是将不同版本的代码包装在条件语句中的能力，您可以随意打开和关闭这些条件语句。你以前可能认为它们是应用程序配置，甚至是你公司规则引擎的一部分。

有了 Harness 特性标志，我们就有了这些您可能熟悉的概念，并进一步发展了它们——添加了更复杂的规则、治理、用户管理、直观的 UI 等等。

特性标志使您能够将特性发布与代码部署分开，构建更有效的策略来推出产品并与您的用户一起测试，并且比以往更深入地了解变化如何影响您的应用程序性能。

最终，特性标志使工程团队能够以更低的风险交付更多的特性。对于领导者来说，这是提高工程速度和开发人员体验，以及降低与特性开发相关的风险的好方法。对于开发人员来说，这是一种更高效、压力更小的好方法——部署前少熬夜，部署后少交火。

## 什么是特征标志(或特征切换)？

特性标志是一种方式，开发人员可以有条件地打开或关闭代码的某些部分。您可以将特性标志视为将持续交付扩展到[持续部署](https://www.atlassian.com/continuous-delivery/principles/continuous-integration-vs-delivery-vs-deployment)——一种将变更置于标志之后并在以后以受控的方式打开它们(或者以同样的方式隐藏和删除它们)的方式。

但是，您也可以将功能标志视为构建和发布应用程序的一种新方式——通过清楚地定义可以更改和单独打开和关闭的功能和组件，您可以进行实验，控制向不同用户的推出，以及让更多的人(如 PMs、销售和支持)为客户打开和关闭东西。

总的来说，这将为开发人员提供更多的能力和控制，以更快地创建更多更好的功能，同时确保工程不会成为业务的瓶颈，因为他们必须为单个客户做出更改，或者确保每个新功能或功能更新的完美生产部署。

如果我们想进一步简化，功能标志本质上是为开发人员创建私人泳道，他们可以直接将功能发送给客户，然后控制谁可以看到它，获得反馈，并根据需要打开和关闭它。就像电灯开关(挺复杂的一种)！

*Devs don’t have to push everything onto a massive pile of other features waiting to deploy.*

### 谁使用功能标志？

人们经常认为特性标志或者是工程工具，或者是产品经理的工具。现实是，两者都有。标志可以帮助软件开发和 DevOps 团队降低他们的开销并提高他们的速度，它们可以帮助产品经理更好地控制发布，协调发布时间并更有效地创建反馈循环。

研究表明，95%的工程领导者希望为自己实现一个特性标志解决方案。这是因为 97%的领导者表示他们面临更快交付的压力，65%的领导者表示他们发现很难以安全的方式实现速度的提高。很明显，工程团队可能是实现和使用特性标志解决方案的最大受益者，事实上，他们往往是主要用户。当他们实施功能标记解决方案时，他们最终每年为每个应用程序多提供 66%的功能！

[*Source*](https://www.prnewswire.com/news-releases/feature-flags-have-gone-mainstream-yet-challenges-remain-reveals-study-from-rollout-and-atlassian-300751151.html)

除了产品和工程之外，功能标志对整个组织的用户都非常有用。对于销售和支持团队来说，功能标志为他们提供了一种直接管理客户的测试版和新功能的方式，并在出现任何问题时跟踪谁在使用什么。对于管理层来说，标志可以提供新形式的可见性，让他们了解开发中发生了什么，以及新特性是如何被用户测试的。

关于“有趣的事实”,因为我们在“谁使用功能标志”部分，很酷地注意到像网飞、Flickr、谷歌、Reddit 等大公司都使用功能标志！它们绝对值得研究，并且绝对是软件交付生命周期的重要组成部分。

*Multiple teams across an organization can leverage feature flags.*

### 为什么应该考虑特性标志

特性标志的使用对于你的软件交付生命周期是否重要取决于你需要完成什么。虽然特性标志对于任何团队来说都是一个很好的工具，但是如果您遇到以下问题，它们会特别有用:

**业务中的问题**

*   与新特性发布相关的风险最终会拖开发人员的后腿，因为他们必须在发布之前彻底验证设计和实现。
*   一个新特性的外观和功能通常有多个可能的版本，由开发人员选择一个(不总是正确的)并实现它。
*   何时发布新软件特性的决定是由开发人员而不是企业来控制的。
*   淘汰旧功能会给可能依赖旧代码的新功能带来风险。
*   要么全有，要么全无——一个特性同时向每个人推出，而不是为了验证的目的逐步推出一个特性。
*   当团队受制于工程发布周期(例如，一个月一次)时，多个特性同时发布，引入了复杂性和风险，可能导致部署作战室、大规模回滚和不满意的客户。

**工程中的问题**

*   发布一个特性需要涉众太多的协调和时间。
*   合并新的特性，或者为变化管理单独的特性分支，既麻烦又复杂。
*   在大范围推广之前，您需要测试这些变化，看看它们对您的应用程序和最终用户有什么影响。
*   您希望提供对新功能的访问，或者更快地测试特定用户群的变化——通过位置、通过客户计划、通过选择 beta 测试的客户，或者通过您能想到的任何其他标准或逻辑。
*   您希望通过不需要回滚或新部署来修复中断的环境的即时终止开关来降低推出新代码的风险。

简单来说，如果您正在尝试做以下事情，我们可以认为特性标志是一个很好的解决方案:

*   提高工程速度，提供更多功能。
*   通过与客户一起 A/B 测试多个解决方案来降低功能开发风险。
*   减少与生产失败和回滚相关的风险和工作。
*   将工程部署从向客户公开功能中分离出来。

## 不同类型的特征标志/切换

想把所有的特性标志用例放在一个桶里是很自然的，但是更有帮助的是把标志本身看作一种达到目的的手段，并且有用例的类别。

下面是一些可以在系统中使用的不同类型标志的示例:

*   **发布特性**——使用标志让合适的人决定谁在什么时候为谁开启特性，而不需要复杂的工程部署协调。
*   **实验**——使用旗帜来了解变化如何影响事物。这可以是一个技术实验，比如一个新的 UI 如何影响服务器负载，也可以是一个用户实验，比如一个新的按钮如何影响转换。
*   **Ops flags**——让你对应用的关键部分拥有永久控制权，这样你就可以根据需要打开和关闭它们，而无需全新的部署周期。添加 RBAC，这是一个控制谁有权修改您的生产应用程序的健壮方法。
*   **控制访问**——使用标志作为管理测试版、早期采用者列表、试用访问等的一种方式。

## 实现功能标志

实现特性标志起初看起来非常简单，但事实证明，就像任何系统一样，细节是最大的问题。在内部构建一个出色的功能标志解决方案当然有它的好处，但是看起来很困难。特别是，随着组织实现的成熟，我们已经看到了特性标志解决方案中出现的三组不同的问题。

当一个特性标志解决方案**不存在或不成熟**并且一个组织第一次提出它时，他们很快就会遇到在工具中寻找价值的问题。尤其是在需要这样一个解决方案并有压力让它快速实现的情况下，快速展示价值是至关重要的，否则它可能会留下一种酸味。在这种情况下，有两种截然不同的方法，一种是为最终的规模进行架构设计，另一种是让 MVP 证明价值。这通常会导致复杂的设计或架构不可扩展，并且只适用于小型的目标用例。

当特征标志解决方案进入**成熟中期**，或者当它们**开始扩展**，问题就很明显了:扩展很难。尤其是在内部构建时，确保该工具可以被多个用户和多个团队用于各种用例，同时维护一组通用的最佳实践并构建在单个基础架构上，这是非常令人生畏的。随着这一点被发现，团队在生产中有代码，当代码发生变化时，它会很快导致陈旧的代码或保持生产整洁的问题。此外，还需要巧妙地融入每个人的工作流程，这样你就有了一个需要解决的大问题。

在此基础上，我们经常看到**高度成熟的**特性标志实现的场景，其中它们最终主要作为独立于现有软件交付或 CI/CD 管道的系统，团队现在必须学习如何使用，并找出如何将他们现有的流程或管道移植到特性标志解决方案中。在这个阶段，为了跟上新的变化或需求，维护和未来开发的成本显而易见。到这个时候，技术债务一定会越积越多，如果没有专门的团队，甚至可能没有自己的代码库，技术债务会变得难以管理。

当然，95%的工程领导者可能想要一个特性标志实现，但是事实证明，构建一个长期有效的东西并不容易。

## 构建或购买:功能标志管理

你可能会想，“特性标志看起来很简单，难道我们不能自己构建它吗？”

真正的答案？很复杂。

我们已经看到，在大多数情况下，一个内部构建的工具最终会导致大量的开销，并使您从特性标志中获得的好处的上限非常低。它可能对您的最初几个标志有好处，但是随着您的组织越来越习惯使用它们——并且越来越依赖它们，要使内部系统可伸缩、高性能并且健壮地完成标志所能做的所有事情可能会很困难。

为了更深入地了解构建与购买的对话，您可以查看我们本月早些时候写的一篇文章，[功能标志:我应该构建还是购买](https://harness.io/blog/product-updates/introducing-harness-feature-flags/)？

## 为什么使用线束进行特征标志管理

Harness 提供了一个功能标志平台，可让您快速启动并运行，同时能够扩展到任何级别。我们使入门变得容易，并很快看到特性标志的好处。有了安全带功能标志，这意味着您可以通过以下三个步骤在几分钟内获得第一面旗帜:

*   创建一个免费试用帐户。
*   只需点击 3 次，即可创建新的旗帜。
*   在几分钟内将我们的 SDK 之一添加到您的代码中。

而且，你有一面旗子在工作！

如果这还不太清楚，那么有必要知道标志在 Harness 这样的环境中工作的基本方式是，作为库添加到您的应用程序中的 SDK 将接收标志状态的更新，以便与您的用户进行评估(您应该在实时流或间隔拉取更新之间进行选择)。这些 SDK 是安全的，不会收集您不想共享的数据，并且它们是为性能和稳定性而设计的。

Harness Feature Flags 快速、安全，并专注于帮助团队最大限度地利用功能标志——从您的第一次初始使用一直到全球治理、复杂的可重用模板和开发人员优先的体验。

如果你想知道我们如何与 LaunchDarkly、Optimizely、Cloudbees 功能管理、Split 和其他 FF 工具相抗衡——这些页面目前正在制作中，当它们上线时，我们会用链接更新这篇文章！

如果你想了解更多关于我们的架构和如何开始的信息，你可以[查看功能标志文档](https://ngdocs.harness.io/article/0a2u2ppp8s-getting-started-with-continuous-features)或者[请求演示](https://harness.io/platform/feature-flags/)。