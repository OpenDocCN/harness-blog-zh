# 持续交付与持续部署:有什么区别？装具

> 原文：<https://www.harness.io/blog/continuous-delivery-vs-continuous-deployment>

CI/CD 的每个部分(持续集成和持续交付)代表了要实现的不同目标和规程。为了进一步混淆视听，持续交付和持续部署都有两个不同的目标。

在 DevOps 的世界里，似乎不缺少“连续”的术语。就像说纸巾是纸巾，可乐是汽水一样，描述整个软件交付管道的一个常见的名称是“CI/CD”然而，CI/CD 的每个部分(持续集成和持续交付)代表了要实现的不同目标和规程。为了进一步混淆视听，持续交付和持续部署都有两个不同的目标。

随着[敏捷开发](https://www.agilealliance.org/agile101/)的出现，曾经每季度发布一次的版本现在看起来很愚蠢，越快越好。基础设施和实践需要到位，以允许变更快速传播。像任何技术一样，不要让语义妨碍您的目标，但是每种技术的工具和实践都是不同的。无论你在哪个连续的旅程中，自动化都是实现每个连续支柱目标的关键，以减少人为干预。

## 持续集成、持续部署和持续交付之间的区别是什么？

软件交付管道的整个目标是将你的想法投入生产。这听起来很无私，但确实有很多步骤可以做到。对于一个软件工程师来说，一旦你的外部客户可以使用这个特性，他们就不会在乎你是如何交付的了。将这种情绪与 DevOps 工程师相比，您的内部客户(开发团队)确实关心一些东西是如何交付的，因为该过程直接影响他们和他们的特性交付。

从代码变更或新代码开始，生产之旅可能会经历许多不同的环境和建立信任的练习，然后才会正式投入生产。技术中唯一不变的就是变化，所以只要一个版本发布，整个过程就会重新开始。随着一个新特性的出现，变化将进入生产阶段。

### 连续累计

持续集成是构建的自动化。根据您的源代码控制/版本控制策略，针对 bug 修复或新特性的代码更改需要被合并/提交到源代码存储库中的一个分支中。无论你站在单回购还是多回购的哪一边，构建——以及最终的发布工件——都将作为持续集成过程的一部分被创建。

#### 为什么它很重要

作为一名软件工程师，你很少单独工作。将您的特性/错误修复集成到应用程序中是软件工程师的一项常见任务。对于只有团队项目经验的新晋软件工程师来说，这可能需要一点时间来适应。快速融合想法的能力是持续集成的巨大吸引力。对于现代系统，构建和打包步骤可能有所不同。例如，在 JAVA 开发中，JAVA 构建产生一个 JAR 文件。然后，将 JAR 文件打包到 Docker 映像中进行部署。

持续集成解决的三个支柱是构建是可重复的、一致的和可用的。在软件中，我们力求实践是可重复的；拥有一个外部化的构建允许这样做，这反过来又会产生一致性。现代的持续集成平台允许扩展构建(在需要的时候让构建可用，而不是让您的本地机器被钉住)。

#### 最佳实践

对于持续集成，保持快速的自动化构建是关键。由于这个过程将在一天内运行多次，每次提交或合并都有触发器，等待结果的时间会像滚雪球一样越滚越大。在持续集成中观察到的一个挑战是超越到其他的持续支柱中，比如持续交付中的持续集成平台负担过重。

对构建和可部署打包的信心不同于对部署和后续发布的信心。为了避免持续集成过程负担过重，在哪里应用测试套件的策略是必要的。沙子上的一条线应该是持续集成处理以工件为中心的信心建立(例如，单元测试和工件扫描)。考虑到其他工件和依赖性和/或应用程序基础设施的测试更适合连续交付过程。在构建被检入中央存储库之后，将您的想法投入生产的下一步是提升/部署过程。

### 持续部署

持续部署关注——顾名思义——部署；钻头的实际安装和分布。在部署过程中，应用程序二进制/打包可以在应用程序或应用程序基础架构需要服务流量的位置上遍历拓扑。从传统意义上来说，连续部署侧重于跨环境或集群部署的自动化。随着您从非生产环境到试运行环境，最终到生产环境，您部署到的终端数量会增加。持续部署关注于将软件引入所需环境的最小阻力的途径。

与遗留或传统的基于机器的平台相比，使用 Kubernetes 等现代平台，环境的分离可能不是物理的。名称空间(软件分离)可能是将开发从生产中分离出来的全部，尽管无论您选择什么平台，良好的分布式系统原则仍然适用。对于分布式系统，变更需要传播到的拓扑可能很大，即使在预生产环境中也是如此。

#### 为什么它很重要

将 SCPing 装入盒子并丢弃二进制发行版的日子几乎已经一去不复返了。由于持续集成提供了一个可部署的工件，持续部署可以将该工件带到其他环境中。低挂的果实可能是一个新的工件一经创建，立即将该工件部署到开发集成和/或质量保证环境中，以开始集成测试。特别是对于现代模式，如不可变的应用程序和基础架构，这意味着任何更改都要重新构建，部署的数量将会显著增加。

#### 最佳实践

部署包括两对:安装/激活对和卸载/停用对。从纯部署的角度来看，利用滚动部署是事实上的标准。滚动部署允许以递增的间隔替换旧的应用程序节点，通常是一个接一个地替换，直到所有节点都是新版本。正在升级的应用程序实例/节点从负载平衡器池中取出，然后在安装完成后，将其重新构建回池中。

拥有一个清晰的拓扑结构图，特别是如果基础设施是弹性的或按需的，是理解工件走向的关键。与持续集成的目标类似，保持快速部署是一个很好的目标。如果某些任务必须并行运行(例如:为将要部署的工件旋转基础设施),速度的外观可能会存在。

理解持续部署和持续交付有稍微不同的目标。在部署方面，连续交付与连续部署有重叠，但我们需要考虑不要让部署系统、信心建立、安全负担过重，这些对于连续交付至关重要。

### 连续交货

技术是会出错的，因为人类创造了技术。建立信心的步骤对于任何做出改变的工程团队来说都是至关重要的。[连续交付](https://harness.io/blog/what-is-continuous-delivery/)是将变更安全投入生产的自动化步骤。连续部署关注的是实际的部署，而连续交付关注的是发布和发布策略。一个难以捉摸的目标是“按下按钮”将改变投入生产。“按一个按钮”就是持续交付。

#### 为什么它很重要

通往发布的道路可以是雪花。由于软件是来自几个团队的选择的顶点，遍历传播/支持变更或新特性所需的所有必要步骤和修改可能是一个曲折的过程。连续交付带来了所有的测试步骤、增量/环境部署和验证步骤，以安全地将变更投入生产。

#### 最佳实践

简单地说，好的管道是快速、安全和可重复的。然而，对于连续交付，没有一个尺寸适合所有人。拥有一个实用的持续交付方法对于采用是至关重要的。很可能在任何企业中，在持续交付之旅之前就有大量的技术选择和平台。

最近，Harness 用我们的[管道模式电子书](https://harness.io/learn/ebooks/ebook-pipeline-patterns/)对组织正在使用的模式进行了一次普查。你的管道结构倾向于遵循他们被驱动的方向。管道由环境、测试、服务、结果或人驱动。管道的形式将遵循函数。

需要注意的一个反模式是由人驱动的。没有自动化，流程将是以人为中心的。随着差距开始缩小，连续交付管道中的手动步骤将会消失。捕获连续交付管道中所需的所有步骤的好处是，可以轻松地识别瓶颈所在，并开始投资于瓶颈中的自动化。

最难自动化的项目之一是部署的验证/推广。当运行测试套件时，结果是二进制的——要么是通过的测试，要么是失败的测试，并且不需要进一步进行部署。验证部署的应用程序是否成功会带来许多问题和需要检查的地方。特别是当用几个增量部署实现一个 [canary release](https://harness.io/blog/blue-green-canary-deployment-strategies/) 策略时，这种验证可以持续发生，甚至应该在部署后进行。将来自不同的监控、可观察性和性能管理解决方案的数据/关键度量关联起来可能是乏味的——尤其是在试图确定基线的时候。Harness 平台消除了这种情况下的猜测。

## 他们如何在软件交付中一起工作

“CI/CD”经常被一起提及是有原因的。简而言之，拥有一个以安全方式部署的工件管道就是软件交付。如果一个组织只有一个每几个月创建一次的工件，并且只有几个节点可以部署，并且可以接受维护期间的停机时间，那么就不需要任何类型的投资。不幸的是，这种情况已经几代人没有出现过了。

您的持续集成过程将保持可以部署的可部署工件的现成供应。您的连续交付过程将编排所有需要的部署和信任建立/发布活动，当工件/新的变更遍历环境/集群时，可能调用您的连续部署基础设施。能够以一种安全的方式快速地部署一个版本将允许组织变得更加敏捷，具有现代的软件交付能力。随着范式的快速转变，问题肯定会出现。

## DevOps 社区的常见问题

以下是我们在不同 DevOps 社区中发现的几个问题，可以帮助进一步描述异同。

### 在持续交付管道中，部署和发布的区别是什么？

部署是安装/激活软件/二进制文件的行为。在部署过程中，如果存在现有版本，则会卸载/停用以前的版本。发布是将变更安全地投入生产的所有活动的高潮。作为版本的一部分，有一个部署组件。不同的发布策略，比如 canary 发布，利用了增量部署策略。发布通常被签署，并且导致应用程序的变更或新版本(新的稳定版本)的所有事件的记录被创建。

### 持续交付中的部署管道清单是什么？

在不涉及部署和软件发布之间的区别的语义的情况下，一个成功部署的清单验证了特性是否符合预期。有了宽画笔，从技术方面的期望将不会违反某种 SLA/SLI/SLO。从功能的角度来看，如果有采用并且在使用上没有下降，那就是成功。清单中的验证步骤可以确保满足 QA 团队的目标(代码/测试覆盖范围),并在浸泡测试等过程中检查出变更。变更是否符合预期，是否符合质量标准，是否可以满足扩展需求？Harness 有助于自动化整个清单。

## 利用 Harness 自动化构建和测试过程

Harness 平台允许您拥有完整的端到端 [CI/CD 管道](https://harness.io/blog/ci-cd-pipeline/)，因此您的想法可以真正以安全的方式进入生产。无论您是希望部署到几个不同的基础设施，还是协调多个建立信任的步骤和测试自动化，Harness 都可以帮助您的开发团队实现一个按钮式的发布。

如果你还没有，请今天就在[注册](https://app.harness.io/auth/#/signup/)这个平台。如果你还没有到那个阶段，请随意做一些进一步的阅读。我们有一本关于[管道模式](https://harness.io/learn/ebooks/ebook-pipeline-patterns/)的电子书，可能会有用。

干杯！

拉维