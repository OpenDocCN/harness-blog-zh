# 功能标志|利用的全球治理政策(OPA)简介

> 原文：<https://www.harness.io/blog/opa-feature-flags>

我们正踏上一段旅程，利用特性标志构建整个系统的关键治理组件，并将它们捆绑在一起。特性标志的治理策略是一个巨大的进步。了解更多。

我们很高兴地宣布推出有史以来第一个由代码为的[治理策略支持的治理特征标志的特征标志治理策略。在 Harness，我们专注于构建优先降低风险的解决方案，并使](https://harness.io/blog/harness-policy-as-code)[软件交付最佳实践](https://harness.io/blog/continuous-delivery/best-practices-software-delivery/)更容易、更安全地采用——所有这些都不会牺牲特性标志给工程组织带来的速度。

功能标志将部署从发布中分离出来，让开发人员对新功能的终止开关、beta 测试、试验和渐进推出有一种控制感。不过，您可能会注意到，在功能标志将帮助您的团队的方式列表中，有一件事是很多功能标志将在生产中发生——并且生产中发生的事情可能会很可怕。

为此，[全球治理政策](https://docs.google.com/document/d/1sG8wQlR5QDNUg3Yx5IZ3wDARhBjCaqK9Wb6mQoQ00eo/edit#heading=h.6ugout24lnr7)对于需要大规模执行标准的工程组织来说是一个巨大的胜利。他们允许在所有版本中设置防护栏，以确保符合标准，并且他们也自动化了该过程，因此开发人员只需在构建和测试阶段以他们习惯的方式获得错误消息。

在 Harness 功能标志中包含全球治理政策，这极大地将 Harness 与市场上的替代产品区分开来。Harness 是唯一的特性标记解决方案，除了针对单个或类别的发布的特定标准之外，它还能够对所有的特性发布实施全面的治理。这种全球治理还扩展到了 Harness 平台上 SLDC 的其他部分，因此像命名约定(举一个简单的例子)这样的东西可以跨 CI、CD 和功能标志强制执行。对于奖励积分，这一切都可以设置一次，并自动执行，而无需开发者动一根手指。相反，它们只会抛出错误和警告，就像来自编译器或测试套件一样。

除了提供快速的初始值并使创建可重复性和规模变得简单之外，这种增强显著地解决了速度和控制之间的内在权衡——现在，您可以同时拥有两者。

## 规模的治理要求

如果你是一名开发人员，当你听到*治理*这个词时，你可能会有点退缩。这听起来很沉重，你可能会想到一些限制性的公司政策，这些政策会阻止你做一些能让你更好更快完成工作的事情。与此同时，你知道在某种程度上，这是不可避免的，因为你不能扩大狂野西部的发布。标准必须到位。

对我们来说，治理是相反的；它应该通过创建护栏让整个团队以一种有凝聚力和安全的方式工作来加快你的速度。治理是关于在整个系统中建立秩序，使团队能够快速移动、构建和交付，而不用担心——也不会吓到领导层。

特别是对于功能标志，您想知道:

*   谁能控制事情，在哪里
*   不同场景下如何保障生产
*   如何确保标志可以使用
*   如何让你的旗帜井然有序
*   如何确保通过遵循政策来保护自己

这就是治理政策发挥作用的地方。他们在系统中创造秩序，让工程团队和领导层回答这些问题，并在他们周围建立护栏。这里的关键是护栏。它不是用来拖你后腿的。事实上，这是为了加快你的速度！想象一下，作为一个开发人员，不必根据内部策略手动检查标记或发布——相反，可以自由地提交代码，知道它将自动根据策略和批准运行。对于管理者来说，除了编写优秀的应用程序之外，不要让开发人员担心任何事情。

## 跨功能发布实施全球治理

我们采用了流行的开源 [OPA(开放策略代理)](https://www.openpolicyagent.org/)项目，并将其作为代码构建到控制策略中，同时提供了直观的用户界面和开箱即用的整套策略。OPA 本身是开源的，并且经过了严格审查，我们很高兴首次将世界级的策略和治理管理引入功能标志空间。

我们在整个平台上构建了这个。那么，这如何具体应用于特性标志呢？简而言之，开发人员可以在 OPA 中编写自己的减压阀脚本，或者使用我们简单的策略生成器来创建规则，然后将这些规则应用于特性标志项目。这都是通过 HPE 管理的。

## 如何将策略用作带有功能标志的代码

您希望对 HPE 和您的功能标志使用哪种策略？功能标志系统中的所有元数据都可以用于定义策略，因此您的团队可以完全控制可以发生什么、何时以及如何使用它。让我们来看看我们提供的一些开箱即用的产品。

您可以非常简单地开始使用这些策略，并立即将这些全球治理标准应用于您的所有功能标志。无论您是使用我们的开箱即用选项，还是编写自己的减压阀脚本，只要功能发布管道运行，这些策略就会自动应用。

## 特性发布管理的全球治理与本地治理

如果您熟悉 Harness，您可能想知道这与您已经可以在 Harness 管道中创建的治理标准有什么不同。简单地把它想象成本地和全球治理应用程序——有点像代码中的本地和全局变量。

即使您不熟悉 Harness，同样的想法也适用于本地治理和全球治理:您可以将特定的策略应用于一种类型的发布，或者在所有的发布中实施全球标准，比如命名约定或者验证某个特性已经在所有的测试环境中得到提升。

管道允许您在特定版本或版本类型的范围内设置特定的标准(参见下面的简单示例)。HPE 策略的不同之处在于，除了您已有的特定发布标准之外，它们还将全球治理应用于您的所有功能发布。这意味着您可以选择创建两层治理，完全根据您的需求定制。

Example of a localized governance policy enforced in a feature release pipeline.

With Harness Feature Flags, a global governance policy can be applied to every feature release pipeline. 

## 以策略为代码的全平台治理

让我们在这里重申，虽然治理策略在您只有利用特性标志的情况下有效，但是它们也适用于整个[利用平台](https://harness.io/blog/product-updates/introducing-harness-policy-engine/)。这意味着使用 Harness uniquely，您可以一起管理 CI、CD、功能标志和任何其他线束模块。

这提供了一些可能性，例如，如果在最后一个小时有一个失败的部署，您就不能在生产中更改特性标志，从而第一次实现了对软件交付过程端到端的真正控制。

## 如何开始

如果您已经在使用 Harness 特性标志，您会注意到一个新的侧边栏选项，标记为 Policies。要开始使用这些由 HPE 支持的全球治理策略，只需在 Harness 控制台中进入功能标志模块，单击策略，然后立即开始应用您自己的策略。一旦你设置好它，并在你的第一个版本上运行它，没有比看到绿色的复选框给你全部清除更好的感觉了。

如果你还没有使用 Harness 功能标志，你可以[注册免费试用](https://app.harness.io/auth/#/signup/?module=ff)或者[请求演示](https://harness.io/demo/)来了解更多。

## 结论:这仅仅是开始

我们正踏上一段旅程，利用特性标志构建整个系统的关键治理组件，并将它们捆绑在一起。功能标志的治理策略是一个巨大的进步，有史以来第一次允许您真正控制您的功能标志系统，并且知道它 100%的时间都在执行，因此可以高枕无忧。您可以在我们的[平台治理页面](https://harness.io/products/platform/governance)上了解更多关于 Harness 和我们治理能力的信息。

如果你还没有报名使用 Harness 但是想入门，可以轻松报名[永远免费](https://app.harness.io/auth/#/signup/)。快乐发展！