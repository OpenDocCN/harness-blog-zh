# 您的生产部署:成功还是失败？装具

> 原文：<https://www.harness.io/blog/production-deployments-actually-succeed-fail>

您刚刚将服务/应用的新版本部署到生产环境中。您打开 web 浏览器，点击生产中的实时版本。一切看起来都很好，是吗？

## 失败很容易理解，成功却不容易

事实是，IT 领域的成功很少被谈论，或者根本没有被定义、衡量或宣传。作为人类，我们期待成功——这叫做“做好我们的工作”另一方面，失败总是被谈论、衡量和交流。

我总是问客户，“您现在如何验证生产部署？”最常见的回答是，“我们手动操作，主要是凭直觉。我们有少数工程师检查日志和监控工具。”第二个最常见的回答通常是笑声，然后是“如果应用程序保持运行”或“如果没有人抱怨。”

底线是部署成功没有被一致地测量或验证。成功是通过旁观者的眼睛，因此，它是非常主观的。我们在工程软件(和工具)上花费了数百万。然而，当涉及到回答最基本的问题时，大多数人仍然难以回答。这些年来，应用程序发生了巨大的变化，但当按下红色的大部署按钮时，组织仍然使用相同的旧指标来尝试并说服自己一切正常。

## 廉价、陈旧和简单的指标是不相关的

我说的是可用性和好的“5 个 9”当然，测量可用性比不测量要好，但是话说回来，您到底测量什么，如何计算可用性？服务器、操作系统、应用程序运行时、端口或第三方 API 的可用性？您可能会得到完全不同的可用性，更不用说随着时间的推移平均这些指标的含义了。

接下来，让我们考虑资源利用率。CPU 尖峰了吗？部署后，服务器的利用率是多少？这一指标在今天是否与云计算、容器和自动扩展相关？为什么 2018 年资源消耗很重要？

正如华尼拉·艾斯曾经说过的:“好了，停下来，合作并倾听”——是时候让团队定义他们的服务、应用和生产部署的成功了。为什么？因为它会让每个人都明白成功和失败到底是什么样子的。

## 衡量业务影响

想象一下，测量为什么业务中有人首先告诉你要构建某个东西的全部原因和假设...想象一下...听起来很疯狂，不是吗？然而，在 IT 领域，我们制造和运输产品，却从未回头去看真正的业务影响到底是什么。

现在是 2018 年，开发人员、It 运营人员或开发人员没有理由不掌握业务指标。像 [AppDynamics](https://www.appdynamics.com/) 、 [New Relic](https://www.newrelic.com/) 和 [Dynatrace](https://www.dynatrace.com/) 这样的应用性能监控(APM)解决方案都允许您从生产中运行的服务和应用中获取业务指标。

如今，衡量服务、应用或商业交易的收入就像衡量响应时间一样简单。因此，如果您拥有这些工具，您真的应该从您的监控平台中提取业务 KPI。是的，您可以保留您的应用程序和基础设施指标，但是如果您的业务 KPI 和指标都符合要求，请不要让它们误导您。

## 如果连续交付也可以验证部署会怎么样？

想象一下，如果您的部署解决方案可以神奇地链接到生产中的监控工具，并告诉您每个部署的确切业务影响。更好的是，如果您的部署解决方案可以在观察到负面业务影响时自动回滚，那会怎么样？我有好消息。你可以用马具做到这一点。

更好的是，您可以执行金丝雀式的部署，以便在部署期间只升级和验证一小部分生产环境，而无需暴露您的整个用户、流量和业务。

例如，下面是 Harness 分析 AppDynamics 数据的持续验证能力的截图。我们基本上使用无监督的机器学习来分析监控工具捕获和管理的数百万个时序指标，但我们是在每个生产部署的上下文中这样做的。我们的部署工作流主要是部署您的新服务/应用，然后连接到您的监控工具，从性能、质量和业务角度分析发生的情况。

正如您在屏幕截图中看到的，在部署后，由 Harness 升级的服务中，一笔业务交易(结账)的每分钟收入实际下降了 77%。在这种情况下，您会希望 Harness 将部署回滚到以前或最后一个工作版本...这就是所发生的事情:

## 定义成功对你的企业到底意味着什么

我已经厌倦了听到基础设施监控；如果没有应用或商业背景，这是毫无意义的。

您最终只能测量一些东西的比特和字节，而无法理解这些比特或字节对您的业务或客户有什么影响。漂亮的仪表板和图表不会告诉你你的客户是否满意，或者你推出的新服务是否真的增加了 34%的收入。

是的，监控您的整个堆栈是重要和有价值的，监控总比什么都不监控好。但是请想一想成功对你的企业实际上意味着什么。获取成功定义，并开始将其应用到您的部署管道中，这样您就可以控制每个部署的成功和失败。

如果您可以衡量每个部署的业务影响，并开始分享您的成功和失败，这不是很棒吗？

干杯，史蒂夫。
@伯顿说