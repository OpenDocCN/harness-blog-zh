<html>
<head>
<title>Harness YAML Editor - Code Away Your CI/CD Pipelines! | Harness</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>驾驭YAML编辑器-代码远离你的CI/CD管道！装具</h1>
<blockquote>原文：<a href="https://www.harness.io/blog/harness-yaml-editor#0001-01-01">https://www.harness.io/blog/harness-yaml-editor#0001-01-01</a></blockquote><div><p>为最终用户提供强大的YAML编辑器体验对我们来说非常重要，因为他们可以帮助他们以一种高效、无错误、开发友好的方式编写/编辑CI/CD管道。</p><div fs-richtext-element="rich-text" class="blog-rtf w-richtext"><p>随着现代DevOps的出现，将持续集成/持续部署(CI/CD) <a href="https://harness.io/blog/pipeline-as-code/" target="_blank">管道配置为代码</a>变得相当流行。最值得注意的是，Kubernetes在将Kubernetes对象定义为代码时，在将YAML作为首选语言的广泛采用中发挥了关键作用。这一点，加上Kubernetes是Harness CI/CD产品中第一个也是最重要的泳道之一，意味着我们必须为最终开发人员提供强大的YAML编辑器体验，以便以高效、无错误和开发人员友好的方式编写/编辑CI/CD管道。</p><p>但是我们真正面对的是什么？我们希望为开发人员创造出色的编辑体验，能够:</p><ul role="list"><li>从头开始创建连接器、机密或管道。</li><li>提供实时模式验证。</li><li>提供智能感知和自动完成。</li><li>提供字段描述和丰富的内联文档。</li><li>最后，提供模板或样本YAML作为一个快速的起点。</li></ul><p>这将解决以下客户使用案例:</p><ul role="list"><li>开发人员必须从头开始创建一个YAML，并需要帮助确定哪些字段应该放入其中。</li><li>开发人员必须修改现有的管道并验证其正确性。</li><li>此外，开发人员必须克隆和编辑现有管道，并快速将当前管道复制为代码。</li></ul><h2>在幕后</h2><figure class="w-richtext-figure-type- "/><p>如果没有对开发人员的任何自动建议和自动完成支持，从构建/部署阶段开始创建CI/CD管道可能会非常困难。此外，它不是关于创建任何管道——它必须是一个在语义上验证CI/CD管道本身的“JSON模式”的管道。JSON Schema是一种语法语言，用于定义JSON对象或YAML文件的结构、内容和(在某种程度上)语义。这与我们的用例更相关。作为构建我们模式框架的一部分，我们还率先从不同的微服务中拼接出一个复杂的YAML模式。例如，用于线束CI/CD管道的组合YAML模式将具有CI和CD阶段，其中这些阶段的单独模式可以由各自的CI和CD微服务提供。</p><p>这些复杂的模式将有助于YAML自动完成YAML中某些真正深度嵌套的级别。例如，对于一个典型的多级CI/CD管道，我们已经实现了大约50个嵌套级别的YAML自动完成。应用服务器根据一个实体的Swagger定义、我们的定制注释和一个Swagger-to-JSON模式转换器，为该实体缝合这个JSON模式。</p><p>从语义上来说，在为一个实体(比如管道)定义JSON模式时，我们引入了“类型”及其相应“规范”字段的概念。例如，CI/CD管道可能有一个阶段类型，可以是“构建”、“部署”或“批准”对应于开发人员选择的类型，必须指定一个spec对象，该对象将包含有关阶段本身的信息。例如，克隆什么代码库，使用什么部署策略，分配什么资源等等。这个设计原则帮助我们为所有的实体(比如连接器、秘密等等)建立了通用的模式模型。</p><h2>用户体验是什么样的？</h2><p>当开发人员为特定实体(如管道)编写/编辑YAML文件时，会根据其JSON模式对其进行语义验证。这将返回YAML中的所有语义验证错误，开发人员应该修复这些错误以获得有效且正确的YAML配置。例如，管道至少应该有一个标识符、名称、组织标识符和项目标识符(见下面的截图)。</p><figure class="w-richtext-figure-type- "/><p>此外，我们内联显示模式验证错误，以突出确切的验证问题(参见下面的屏幕截图)和预期的开发人员修复它的操作(参见后面的屏幕截图)。</p><figure class="w-richtext-figure-type- "/><figure class="w-richtext-figure-type- "/><p>除了为实体提供针对JSON模式的智能自动建议之外，Harness的YAML编辑器还可以为YAML中的特定字段注入定制建议。例如，如果CI/CD管道必须在构建/部署阶段引用现有的连接器或机密，我们可以根据YAML中的“<strong> connectorRef </strong>或“<strong> secretRef </strong>”字段，在下拉列表中登记每个连接器或机密引用(“引用”)。这是一个强大的开发人员体验，因为开发人员不必导航到另一个屏幕来找出要在管道中指定的连接器或秘密引用。</p><figure class="w-richtext-figure-type- "/><p>类似地，编辑器也可以将每个管道变量作为字段的下拉列表进行提示(参见下面的屏幕截图)。这个以开发人员为中心的特性允许在管道中无缝引用管道变量。</p><figure class="w-richtext-figure-type- "/><p><br/>最后，编辑器还允许自动完成部分管道变量作为输入。例如，当开发人员输入“&lt; +pipeline.variables”触发自动完成时，我们只向开发人员显示下拉列表中以“pipeline.variables”开头的管道变量(参见下面的截图)。</p><figure class="w-richtext-figure-type- "/><h2>多走一步</h2><p>即使在提供了具有智能感知和自动完成功能的强大编辑器体验之后，我们仍然觉得从头编写一个完整的YAML对于一个可能不熟悉YAML语言或者一般概念上的管道的人来说可能有点太难了。为了解决这个问题，我们设计了一个Snippets部分，它提供了现成的YAMLs，可以在编辑器窗格中立即复制/粘贴，并根据需要进行编辑，以快速创建连接器、秘密或管道(参见下面的截图)。</p><p>到目前为止，对于大多数线束实体来说，该特性仍处于积极开发中。然而，它确实为一个伟大的市场体验铺平了道路，帮助开发人员只需点击几下鼠标，就可以像YAML一样开始创建管道或连接器。</p><figure class="w-richtext-figure-type- "/><h2>摘要</h2><p>Harness的YAML编辑器为现代DevOps解决方案带来了巨大的潜力，提供了一流的用户体验，并帮助开发人员减少了设置和维护CI/CD管道的总时间。</p><p>想了解更多关于CI和CD的知识？几周前，我们发布了CI 的<a href="https://harness.io/blog/templates-harness-ci/" target="_blank">模板——旨在为您节省大量时间。在CD端，这里有一个关于使用Redis Streams </a>的<a href="https://harness.io/blog/event-driven-architecture-redis-streams/" target="_blank">事件驱动架构的很酷的技术深度挖掘。</a></p><p><em>本文由阿比纳夫·辛格、拉玛·图马拉和瓦尔丹·班萨尔合作撰写。</em></p></div></div>    
</body>
</html>