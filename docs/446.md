# 为什么要将 CI/CD 与功能标志|线束进行本机集成

> 原文：<https://www.harness.io/blog/integrate-cicd-feature-flags>

CI/CD 和特性标志:我们已经写了为什么在过去将它们结合起来是有意义的——下面是对原生集成的更深入的探讨。

在 Harness，我们发现自己在谈论 CI/CD 和特性标志的价值。这实际上并不是我们产品策略的关键，因为我们所有线束模块的目标是构建一个足够好的产品来销售(针对该领域的竞争对手)。

我们构建的工具是市场上最好的，而不仅仅是捆绑在一起。但是，在一个公共平台上构建工具时，我们总是在寻找将模块一起使用的效果最大化的方法。特性标志和 CI/CD 在本机集成时的影响比我们预期的更显著——尽管有些不同。

## 最初:单一管道

当我们第一次开始研究这个问题时，我们有一个理论，即在一个统一的管道中端到端地建模您的整个软件版本可能是 CI/CD 和功能标志一起的杀手级应用程序——从构建到部署到逐步推出功能，都在一个管道中。

不过我们发现，在某些情况下，公司肯定会遇到将 CI/CD 和功能标志结合在一起的情况(稍后会有更多介绍)，但这不是日常用例。对于大多数标志和部署，用户希望它们在单独的管道中。

虽然这种认识并不意味着我们的理论毫无价值——因为有时它是有意义的，并且拥有这种能力是很棒的——但这确实意味着我们必须更深入地了解好处是什么。

有趣的是，到目前为止，我们正在积极地与客户讨论利用特性标志，并且我们在内部将它与 CI/CD 一起使用，因此我们知道将它们放在一起会更好。我们不是在试图强迫价值发生的捕鱼探险。我们必须弄清楚*为什么*和*在一起会更好。*

## 为什么将功能标志和 CI/CD 结合使用是有意义的

### 原因 1:标准化的 UX

大多数情况下，您的功能标志展开和部署可能不会共享相同的管道。但是，您在相同的 UX 中构建这些行为，使用相同的术语，并共享相同的选项，这一事实会产生一种累积效应，使 CI/CD 和功能标志上的事情更容易管理、理解和提升团队成员。

看一下上面的两个简单的管道示例——一个用于部署，一个用于通过特性标志推出特性——您可以看到两者的外观、感觉和工作方式是如何相同的。

### 原因 2:花在管理团队和访问上的时间更少

每个接触 prod 的系统都是一个风险，每个开发工具都是员工入职和离职的需求。管理生产访问、RBAC、团队结构、项目结构——然后是审计、应用治理规则和监督——所有这些事情都需要大量的时间成本(高技能人员辛苦地从事琐碎的工作),也有可能错过一些东西。让我们面对现实吧，我们都曾在某个地方工作过，六个月前的前雇员仍然可以使用工具。

通过共享关键配置，如环境、团队和项目，当在单个平台上考虑时，设置、人员管理和风险机会的数量都得到显著改善。生产，利用，跨越 CI/CD/FF。将某人添加到具有权限级别的团队可以应用于所有模块。没有必要一次又一次地做事情。

### 原因 3:弄清楚发生了什么

昨天在 prod 发生了什么？如果您使用大多数工具链，找出这些信息需要三或四个选项卡，可能还需要一些数据导出。也许是同一个人能接触到所有这些，也许不是。希望没有缺口，并且您没有跨不同团队的数据孤岛。

如果您用 Harness 问同样的问题，您会得到跨越 CI、CD 和特性标志的仪表板，以及您环境中所有活动的组合[审计日志](https://harness.io/blog/continuous-delivery/audit-trails/)。很简单，*而不是*几乎不可能轻易发现发生了什么，什么时候发生的。所有常见的挖掘、混合数据以及跨多种工具将时间线或故事情节联系在一起的做法都消失了。

根据我们的经验，这让运营团队、工程管理和客户支持团队感觉好多了。故障通常发生在接缝处，没有带线束的接缝。例如，我们自己的运营团队能够在一个统一的平台内轻松查看包含由功能标志控制的新配置的部署何时完成，以及它在什么[环境](https://harness.io/blog/continuous-delivery/deployment-environments/)中启用，以及谁有权访问。

### 原因 4:组合管道(当它有意义的时候！)

我前面提到过[将 CI/CD 和 Feature Flags](https://harness.io/blog/feature-flags/combining-cicd-and-feature-flags/) 活动合并到一个管道中并不总是有意义的，但是在正确的环境中，这绝对是天赐之物。

较小变更的日常部署可能不太适合这种组合管道。然而，有些时候你正在做一个更重要、更协调的改变。假设作为部署的一部分，您正在将大量用户数据迁移到一个新的子系统，并且您希望在新的子系统上按区域增加部署后的用户。

在这种情况下，组合管道是完成这项复杂任务最简单、最容易管理和观察的方式。

*A CI/CD pipeline with a feature flag stage seamlessly integrated in.*

考虑将它用于您更谨慎、定制的发布场景，例如需要非典型协调、仔细规划的流量斜坡或部署后观察窗口的特性。

你可能不需要在每个部署中都使用它，但是毫无疑问，当你需要它的时候，它会改变游戏规则。最重要的是，这些管道可以进行全局管理，允许您设置诸如“如果部署在过去 5 分钟内出现问题，则不允许更改 prod 标志”之类的策略，从而使整个工具链安全合规。

### 我们会再重复一遍:当它有意义的时候

本机集成 CI/CD 和功能标志对我们 Harness 来说是一次探索之旅。我们发现，在认知负荷、组织管理、改进的治理和降低的风险方面的好处与在独特的端到端管道方面的好处一样多。

在适当的情况下，一起构建管道的能力会产生巨大的影响，但是将这些工具放在一起，您将获得日常价值。

想试试功能标志，玩玩这些很酷的功能吗？[今天就注册免费试用](https://app.harness.io/auth/#/signup/?module=ff)。