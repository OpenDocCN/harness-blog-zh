<html>
<head>
<title>Deploy Your Simple Node.js Application Using Local Docker Images in Minikube | Harness</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>使用Minikube | Harness中的本地Docker映像部署简单的Node.js应用程序</h1>
<blockquote>原文：<a href="https://www.harness.io/blog/deploy-your-simple-node-js-application-using-local-docker-images-in-minikube#0001-01-01">https://www.harness.io/blog/deploy-your-simple-node-js-application-using-local-docker-images-in-minikube#0001-01-01</a></blockquote><div><p>学习如何使用一个简单的Node.js应用程序，了解如何使用本地映像在minikube上构建和部署应用程序。</p><div fs-richtext-element="rich-text" class="blog-rtf w-richtext"><p>我们有一个简单的Node.js应用程序，我们将在本教程中使用它来演示如何使用本地映像在minikube上构建和部署应用程序。</p><h3>先决条件:</h3><h3>Minikube是什么？</h3><p>Minikube是一种轻量级的Kubernetes方法，用于运行只有一个节点的简单集群来测试我们的应用程序。Minikube可用于Linux、macOS和Windows系统。</p><p>辅导的</p><p>创建一个新目录来存储您的简单应用程序代码。克隆<a href="https://github.com/pavanbelagatti/Simple-Node-App">这个回购</a>。</p><p>克隆存储库后，请执行“npm install”来安装所需的依赖项。</p><p>您的应用程序和docker文件现在可以在本地构建应用程序了。下一步是在Minikube上构建映像。因此，我们必须使用以下命令启动minikube:</p><p>minikube启动</p><p>您应该会在终端上看到类似如下的输出:</p><figure class="w-richtext-figure-type- "/><p>这将启动所需的机器和资源。</p><p>接下来，让Minikube访问您的本地Docker图像。</p><p>您应该在根文件夹中看到docker文件，它指定了构建映像的指令:</p><p>从节点:14-阿尔卑斯山作为发展</p><p>环境节点_环境开发</p><p>#添加工作目录</p><p>工作目录/应用程序</p><p>#缓存和安装依赖项</p><p>复制package.json。</p><p>运行npm安装</p><p>#复制应用程序文件</p><p>收到。。</p><p>#暴露端口</p><p>曝光3002</p><p>#启动应用程序</p><p>CMD [ "node "，" app.js" ]</p><p>此外，还有一个. dockerignore文件，它允许我们从上下文中排除文件，并使您的构建更快。在这个文件中，我刚刚包含了node_modules。</p><p>根目录下有一个YAML文件(deployment.yaml ),这是在Kubernetes上运行web服务器的部署配置。打开文件，您应该看到以下内容:</p><p>apiVersion: apps/v1</p><p>种类:部署</p><p>元数据:</p><p>名称:应用程序部署</p><p>标签:</p><p>应用程序:节点应用程序</p><p>规格:</p><p>副本:2</p><p>选择器:</p><p>匹配标签:</p><p>应用程序:节点应用程序</p><p>模板:</p><p>元数据:</p><p>标签:</p><p>应用程序:节点应用程序</p><p>规格:</p><p>容器:</p><p>-名称:应用程序部署</p><p>图片:帕万萨/孟买-应用程序:最新</p><p>资源:</p><p>请求:</p><p>中央处理器:“100米”</p><p>imagePullPolicy: IfNotPresent</p><p>端口:</p><p>-集装箱港口:3002</p><p>ImagePullPolicy设置为“Never ”,因为我们不会从图像注册表(如DockerHub)中提取任何图像。如果您指定为“总是”，那么图像将从注册表中搜索并最终提取。</p><p>使用以下命令创建部署:</p><p>kubectl apply -f deployment.yaml</p><p>终端上的输出应该如下所示:</p><p>deployment.apps/nodeapp创造了</p><p>Minikube无法访问您的本地Docker图像。这意味着是时候将图像加载到minikube上了。</p><p>让我们使用以下命令直接在minikube上构建映像:</p><p>minikube映像构建-t mynode/app。</p><p>[语法:minikube image build -t <image name="">。]</image></p><p>您应该会看到以下输出:</p><figure class="w-richtext-figure-type- "/><p>让我们使用以下命令来验证这一点:</p><p>库贝克特尔日志deployment.apps/nodeapp</p><p>运行上述命令后，您将看到应用程序运行消息，类似于以下内容:</p><p>服务器在localhost:3002上运行</p><p>检查浏览器，您应该会看到以下消息:</p><figure class="w-richtext-figure-type- "/><p>您也可以通过访问Docker桌面仪表板来验证这一点。您应该看到容器正在运行。</p><figure class="w-richtext-figure-type- "/><p>恭喜你！您已经将您的应用程序容器化并推送到minikube集群上。</p><h2>使用线束CD展开</h2><p>只要你是在一个小团队中学习和试验，Minikube就能很好地工作，但是如果你的项目并不小，而且有相当多的开发人员在工作呢？然后，您可以利用Harness CD的力量来部署您的应用程序。Harness CD使Kubernetes部署变得简单，并为您的管道提供了单一平台。</p><p>注册免费试用<a href="https://app.harness.io/auth/#/signin">线束</a>并选择<em> TryNextGen </em>选项卡获得无缝体验。创建一个新项目并选择连续交付模块。开始创建新的管道，并添加管道所需的所有细节。</p><figure class="w-richtext-figure-type- "/><figure class="w-richtext-figure-type- "/><p><strong> <em>注意:</em> </strong>为了让Harness发挥它的魔力，您需要一个叫做“委托”的东西在您的Kubernetes集群上运行。别担心，我们有一个简单的教程来帮助你<a href="https://docs.google.com/document/d/12jRJiwZ2jbtrrBqRykokpc2ai-ZN0OEqqNcrYrsHwy4/edit?usp=sharing">设置代理</a>。</p><figure class="w-richtext-figure-type- "/><p>接下来，为您的应用程序指定服务、基础设施和部署策略。设置好一切后，保存配置并运行以部署应用程序。</p><figure class="w-richtext-figure-type- "/><p>这就对了。一旦管道成功运行，您应该看到您的应用程序部署在指定的Kubernetes集群上。这可以通过kubectl命令“kubectl get pods”来验证。</p><p>再次感谢您的阅读，别忘了<a href="https://app.harness.io/auth/#/signup/?module=cd">注册线束光盘免费试用</a>。</p></div></div>    
</body>
</html>