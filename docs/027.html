<html>
<head>
<title>GraphQL: Harness Your Way | Harness</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>GraphQL:驾驭你的方式|驾驭</h1>
<blockquote>原文：<a href="https://www.harness.io/blog/graphql-harness-your-way#0001-01-01">https://www.harness.io/blog/graphql-harness-your-way#0001-01-01</a></blockquote><div><p>几乎所有Harness有意义的实体都通过API公开，包括应用程序、服务、云提供商、环境、工作流、管道、部署的实例和部署数据。这篇文章分享了如何使用GraphQL与Harness API进行交互。</p><div fs-richtext-element="rich-text" class="blog-rtf w-richtext"><p>今年早些时候，我们宣布了对<a href="https://developer.harness.io/docs/platform/apis/api-quickstart/" target="_blank"> Harness API </a>的更新。我们介绍了通过GraphQL与Harness API交互的能力。这篇博文将分享对GraphQL的更多见解，为您提供与Harness API交互所需的知识。<br/> <br/>我们先从一个graphQL入门开始吧！</p><h2>GraphQL是什么？</h2><p>GraphQL ，它是一种由脸书创建的开源API查询语言，支持声明性数据提取。自从引入以来，GraphQL已经将developer mindshare作为REST APIs的替代方案，为API开发人员和用户在使用RESTful架构时遇到的问题提供解决方案。</p><p>使用GraphQL的最大优势是它的灵活性。GraphQL不使用返回固定数据结构的多个端点，而是公开一个端点并响应多个查询。顾名思义，GraphQL以图形结构对您的业务领域建模。表示为图结构的节点和边的字段和关系最小化了每个请求在客户机和服务器之间传递的数据量。</p><p>客户机在查询中精确地指定它需要的数据，响应的结构精确地遵循由查询定义的嵌套结构。这可以防止常见的数据过度提取(返回一个查询，其中客户端拥有的信息多于所需信息)或数据不足提取(因此需要多次查询)的问题。<br/></p><p>为了定义API的能力，GraphQL要求使用<a href="https://graphql.org/learn/schema/"> GraphQL模式定义语言</a> (SDL)在模式中定义对象类型。这个模式充当客户机和服务器之间的契约，定义客户机如何访问数据。这有利于开发团队，因为他们已经定义了一种共享的语言和对领域模型的理解。<br/></p><p>这里有一些SDL的例子。</p><p>//定义一个人:<br/> <br/>类型人{ <br/>姓名:字符串！<br/>年龄:Int！<br/> } <br/> <br/> //表达帖子与人的关系:<br/> <br/>类型帖子{ <br/>标题:字符串！<br/>作者:人！<br/>}<br/><br/>//表达关系的另一端。一人多岗:<br/> <br/>类型人{ <br/>姓名:字符串！<br/>年龄:Int！<br/>帖子:【帖子！]!<br/> }</p><p>这些示例显示了对象具有强类型字段。结尾带有感叹号的字段表示必填字段，这些字段将是客户端请求的一部分。</p><p>一旦GraphQL服务开始运行，它就可以接收查询以根据模式进行验证和执行。检查查询以确保它只引用定义的类型和字段，然后运行函数产生结果。例如查询:</p><p>{ <br/>帖子{ <br/>标题<br/>作者<br/> } <br/> }</p><p>可能会产生JSON结果:</p><p>{ <br/> "post": { <br/> "title ":《星球大战》，<br/> "author ":《卢克·天行者》<br/> } <br/> }</p><p>理解了SDL之后，您就可以开始使用Harness的API Explorer来执行查询和变异了。让我们讨论一下API Explorer的一些特性和例子。</p><h2>线束API资源管理器</h2><p>Harness API Explorer使用户能够对Harness实体执行CRUD操作。API Explorer基于一个名为<a href="https://github.com/graphql/graphiql"> GraphQL </a>的GraphQL集成开发环境(IDE)。在屏幕左侧的顶部可以找到功能按钮，一个编辑器，和一个“查询变量”,用于传递突变变量。</p><figure class="w-richtext-figure-type- "><figcaption>Use the right side of the screen to look up query and mutation schemas. Use the left side of the screen to run GraphQL queries against Harness. </figcaption></figure><p>文档资源管理器让您可以轻松地对查询进行建模。单击浏览器右侧的文档超链接，访问文档浏览器。您可以利用搜索栏功能快速访问特定于Harness的模式详细信息。<br/> <br/>下面是如何在API explorer中做一个简单的查询。如视频所示，我编辑了查询以返回关于应用程序的更多信息。</p><p>如果您想获取基于applicationID的服务列表，您可以在如下所示的查询中指定。</p><p>{ <br/>服务(<br/>过滤器:[ <br/> {应用:{ operator: EQUALS，values:["&lt;application id&gt;"]}<br/>}<br/>限制:1000 <br/> ) { <br/> pageInfo { <br/>合计<br/> } <br/>节点{ <br/> id <br/>名称<br/> } <br/> } <br/> }</p><p>请注意，query.services函数返回分页的数据，因此我们在查询中包含pageinfo和nodes对象来形成返回。<br/> <br/>关于基本查询的更多示例，请参见文档章节<a href="https://developer.harness.io/docs/platform/apis/api-quickstart/#notes">此处</a>。</p><p>突变提供了一种修改(创建、更新、删除)服务器端数据的方法。下面是一个在Harness中创建应用程序的变异示例。<br/></p><figure class="w-richtext-figure-type- "/><p>我首先定义了变异，我称之为createApp，它将一个名为App的查询变量作为必需的CreateApplicationInput。我使用createApplication功能并传递<strong> app </strong>作为输入。输入至少需要一个名称字段，因此我使用必填字段以及clientMutationId和应用程序描述来定义查询变量。我希望获得创建的应用程序的名称和id以及clientMutationId，所以我在第3-8行中指定了该返回。</p><p>通过变异，您可以创建、更新和删除线束对象，包括用户、应用程序、机密和管道。如果你想要更多的查询和变异的例子，请看Harness API文档<a href="https://developer.harness.io/docs/platform/APIs/harness-rest-api-reference">这里</a>。</p><h2>驾驭你的方式</h2><p>几乎所有Harness有意义的实体都通过API公开，包括应用程序、服务、工件、云提供商、环境、工作流、管道、部署的实例和部署数据。我们在二月份的<a href="https://harness.io/blog/product-updates/harness-product-update-february-2020/" target="_blank">产品更新</a>中宣布了使用GraphQL与Harness API交互的能力。GraphQL为您的消费应用程序提供了这些效率和可靠性特性:</p><ul role="list"><li>范围——每个请求可以查询您想要的所有资源和数据，并且只查询您想要的数据。</li><li>自省——您的客户端应用程序可以查询API模式以获得关于API的详细信息。</li><li>层次结构——查询的嵌套字段反映了查询返回的JSON数据的结构。</li><li>强类型化——应用程序可以为每个字段指定预期的数据类型，并接收清晰具体的错误通知。</li><li>面向未来——graph QL允许我们逐步公开新的字段和类型，并淘汰过时的字段，而无需对API进行版本控制或中断您现有的查询。</li></ul><p>这篇博客分享了GraphQL的基础知识以及如何使用Harness API Explorer。您也可以通过Postman 执行<a href="https://developer.harness.io/docs/first-gen/firstgen-fa-qs/harness-graph-ql-api-faqs/">线束GraphQL查询，参见线束文档进行设置。</a></p><p>如果你想了解更多关于GraphQL的知识<a href="https://graphql.org/learn/" target="_blank">，点击这里</a>获取官方学习链接。我希望这能很好地为您提供使用GraphQL的资源，以您自己的方式使用Harness。</p><p>干杯！<br/> - Tiff <br/> <br/> <br/></p></div></div>    
</body>
</html>