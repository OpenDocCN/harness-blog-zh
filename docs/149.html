<html>
<head>
<title>Control and Velocity in Production: Combining CI/CD and Feature Flags | Harness</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>生产中的控制和速度:结合 CI/CD 和特征标志|利用</h1>
<blockquote>原文：<a href="https://www.harness.io/blog/combining-cicd-and-feature-flags#0001-01-01">https://www.harness.io/blog/combining-cicd-and-feature-flags#0001-01-01</a></blockquote><div><p>CI/CD 和功能标志就像蝙蝠侠和罗宾一样:单独强大，但作为一个整体不可阻挡。了解有关统一管道价值的更多信息。</p><div fs-richtext-element="rich-text" class="blog-rtf w-richtext"><p>需要更快更安全地交付软件是必然的结果。工程团队不断地试图比以前更快地交付软件，但不会给系统带来更多的风险。</p><p>作为这一演变的一部分，软件交付管道诞生了，最著名的是 CI/CD。然而，当团队推进 CI/CD 的边界时，他们发现他们在过程的末尾遇到了新的问题。经典。</p><p>在这篇博文中，我们将探索这个问题的末端:部署。您可以期望了解特性标记与此的关系。</p><h2>为什么是软件交付管道？</h2><p>无论你称之为管道、过程、生命周期或任何其他术语，想法都是一样的——不断有变化和新特性被开发出来，他们需要把它们交到客户手中。</p><p>尤其是当你扩展时，你<em>需要</em>一种交付软件的标准方式:<a href="https://harness.io/blog/continuous-delivery/software-delivery-pipeline/" target="_blank">管道</a>。这可以确保您运送的货物始终符合要求，并最大限度地降低您的风险(当然还有返工和消防演习的可能性)。</p><p>更快更安全地交付软件是团队采用 CI/CD 的原因。现在，团队也采用特征标志来进一步扩展软件交付管道。与 CI 的最终结果(工件)被 CD 管道消费的方式相同，CD 的最终结果(部署)被特性标记系统消费以采取下一步。</p><p>但是为什么团队需要采用特征标志呢？在代码被部署到产品中之后，我们不是已经准备好了吗？啊哈！问题就在这里:一旦我们进入生产阶段，会发生什么。</p><h2>CD 的局限性</h2><p>让我们从显而易见的陈述开始:当代码被部署到生产时，CD 就结束了。一旦部署生效，您所拥有的控制仅限于回滚整个部署。您无法控制部署的内容，并且如果不将整个部署从生产中撤出，您就无法解决生产中的单点故障。让这种情况持续一分钟:当你开始生产的时候，你就失去了控制。一想到要做那种荒谬的事情，你可能会感到一阵恶心。</p><figure class="w-richtext-figure-type- "><figcaption><em>Once you deploy… Godspeed.</em></figcaption></figure><p>然而，现实是，许多团队每天都在经历这种情况。在产品投入生产之前，他们需要速度和控制，但是一旦产品越过众所周知的那堵墙，他们对发生的事情的控制是有限的。这可能会在部署前后产生一些有趣的问题。</p><h3>部署前</h3><ul role="list"><li>部署规模越来越大，增加了风险，导致部署过程耗时更长，压力更大。</li><li>部署受到未准备好的个别变更的阻碍。</li><li>必须构建应用程序配置、数据库标志或环境变量，以实现对特定用户集的发布控制。</li><li>多个“版本”或长期源代码控制分支，以满足客户截然不同的特性集需求。</li></ul><p>这里的问题是，即使完成了所有这些，部署仍然会令人难以置信地紧张，按下“开始”就像按下电影中的红色大按钮一样具有戏剧性。这里最重要的是，如果出了问题，大家都要全力以赴。这不仅给开发人员带来压力，还会降低新特性的开发速度，因为开发团队不得不返工。</p><p>除此之外，根据客户档案创建多种体验(例如，免费用户与付费用户)可能会很麻烦，而且并不总是能达到预期效果。但问题是，这种控制在部署之后是必要的——不仅对于工程团队，对于产品、销售和客户成功团队也是如此。</p><h3>部署后</h3><ul role="list"><li>如果部署了 50 个变更，只有一个有问题，那么整个部署都需要回滚。</li><li>难以控制哪些客户可以访问指定的功能，工程人员通常必须手动完成。</li><li>很难使用数据来了解具体的变化或新功能与预期相比表现如何。</li><li>真实世界的数据通常会导致某种意想不到的行为，需要返工，或者在最坏的情况下，完全部署回滚。</li></ul><p>尽管我们的初衷是好的，但我们经常发现，在生产过程中，我们最终会陷入一片混乱。笨重的客户体验控件经常会中断，长期的功能分支会导致奇怪的合并问题，如果有什么东西中断了…好吧…向一长串紧张而愤怒的工程师问好。尽管知道生产中需要发生什么，但如果没有一个合适的生产系统来建立控制并消除所有这些障碍，就很难获得控制并实现正确的目标。</p><h2>功能标志的作用</h2><p>当我说需要一个<a href="https://harness.io/blog/feature-flags/feature-flag-management-tools/" target="_blank">特征标志管理系统</a>来解决 CD 的局限性时，就不会有什么惊讶了。难道这没有意义吗？团队已经在尝试用他们现有的工具实现<a href="https://harness.io/blog/feature-flags/what-are-feature-flags/" target="_blank">特征标志</a>。</p><figure class="w-richtext-figure-type- "><figcaption><em>Feature flags + CD = Velocity and Control in software delivery</em></figcaption></figure><p>部署后失去控制是可怕的，也是有风险的。不仅仅是开发人员的压力达到了顶点，在生产中失去控制也会对业务产生切实的影响——尤其是在出现问题的时候！这是特性标志的第一个作用。</p><h3>生产控制</h3><p>如果你有一个特征标记系统，你会立即意识到很多价值。对于开发和 DevOps 团队来说，知道一旦部署了新的变更和特性，您不会失去对它们的控制是非常重要的。请允许我列出使用特性标志来控制生产的好处:</p><ul role="list"><li>你有第一道防线。如果出现问题，可以在生产中的特征级进行处理。不再因为一个不好的特性而回滚整体部署。这就像为每个功能创建一个易于访问的终止开关。在这篇博客中，我们将更深入地探讨<a href="https://harness.io/blog/feature-flags/kill-switches/" target="_blank">这个话题。</a></li><li><strong>为客户简化功能访问控制。</strong>与运行时配置不同，您可以精确定义哪一组用户可以访问单独的功能。这里的一个直接用例是测试版与正式版或者付费用户与免费用户的划分。</li><li>将部署与发布分离。部署并不意味着所有用户都可以立即访问部署中的所有内容。但如果只有 CD，情况往往会是这样。功能标志允许您在关闭状态下部署一切，然后<em>然后</em>您可以选择该功能何时对客户开放，以及谁可以访问它。</li><li><strong>授权给非技术团队，卸下工程的重担。</strong>在一个没有特性标志的世界里，工程师不幸成为客户需求的瓶颈，不得不手动打开和关闭特性和权限。一旦投入生产，功能标志就可以让您将控制权移交给面向客户的团队，这样他们就可以管理客户体验，而您可以让工程师回到他们的主要工作上。</li><li><strong>生产中的测试代码。</strong>在生产前环境中，您只能测试这么多。一旦真正的数据开始流入，你就知道解决方案的好坏了。功能标志允许您向指定的用户群部署多个解决方案实现(甚至一个)，并查看什么能最好地解决客户问题，或者该功能是否已准备就绪。在这篇博客中，我们将更深入地探讨这个话题<a href="https://harness.io/blog/feature-flags/testing-in-production/" target="_blank">。</a></li></ul><h3>软件交付的速度</h3><p>硬币的另一面是特性标志如何让你在软件交付过程中实现更高的速度。回想一下，首先，CD 确实提高了速度，但是随着部署变得更大，回报往往会减少，因为 1)更多的风险，以及 2)需要完成更多的功能/变更。那么特性标志对此有什么好处呢？</p><ul role="list"><li><strong>部署不发布。</strong>将尚未准备好的代码放在标志后面，投入生产，并在向所有用户推广之前，在小规模用户群中测试功能。现在，只要一切顺利，部署就可以按计划按时进行。</li><li>分成小块部署。这乍一看似乎违反直觉，但如果你仔细想想，通过更频繁、更小规模地部署，你不就能交付得更快、风险集中程度更低吗？特性标志允许你在事情准备好的时候发布，这最终让工程师按照他们自己的步调前进——而不是最慢或最大版本的步调。</li><li><strong>缓解工程瓶颈。</strong>功能标志释放了之前用于为客户进行手动更改的工程带宽。这对客户来说是双重打击，他们的请求得到解决的速度要快得多，而且新功能也能更快地获得。</li><li><strong>反馈，反馈，反馈。</strong>您如何知道自己是否为用户打造了最佳解决方案？答案永远是反馈——但是你如何更快地得到更多的反馈呢？你能把 3 个月的过程变成 1 个月的过程吗？使用特性标志，这是团队能够开始做得更好的地方。似乎增加更多的反馈点会减慢这个过程，但实际上它会更快！</li></ul><h2>将 CD 和功能标志分开是没有意义的</h2><p>功能标志对于 CD 就像 CD 对于 CI 一样重要。是自然的后续让它不是 CI/CD 而是 CI/CD/FF。同样的逻辑也适用-你需要 CD 来正确地做 CI，你需要 FF 来正确地做 CD。其实我换个方式问:为什么<em>不会</em>你们一起做 CD 和 FF？</p><p>就像蝙蝠侠和罗宾一样，这两者的结合真正实现了软件交付中速度和控制的目标。CD 是关于尽可能快地运输，但是这个速度受到你运输的可靠性和质量的限制。特性标志通过始终如一地保证运输安全消除了这一障碍，解放了工程师，使他们专注于最重要的事情——而不是软件交付的压力。</p><figure class="w-richtext-align-fullwidth w-richtext-figure-type-image"><figcaption><em>The masked crusaders: bringing justice to software delivery.</em></figcaption></figure><p>事实上，在 DORA 指标<a href="https://cloud.google.com/blog/products/devops-sre/using-the-four-keys-to-measure-your-devops-performance" target="_blank">上，使用特性标志的团队通常比只使用 CD 的团队表现更好:</a></p><ul role="list"><li>部署频率增加 80%</li><li><a href="https://harness.io/blog/metrikus-commit-to-prod-time/" target="_blank">从提交到部署的时间减少了 66%</a></li><li>90%的事件在一天内得到解决</li></ul><p>团队想要真正的速度和真正的控制，而不是中途停滞不前。他们希望最小化风险和压力，最大化新特性的质量和数量。虽然特色旗帜或 CD 本身使团队更接近这一愿景，但直到蝙蝠侠和罗宾合作，这一未来才真正实现。</p><h3>真正的带吊带连续输送</h3><p>事实是，大多数特性标志实现导致与 CD 的断开，这引入了不必要的风险，并使管理和可见性变得支离破碎——这不是您想要的关键任务系统。您错过了度量、审计日志、治理和安全性。</p><p>这就是马具的用处。<a href="https://harness.io/products/continuous-delivery/" target="_blank">综 CD </a>和<a href="https://harness.io/products/feature-flags/" target="_blank">综特征标志</a>共同提供了完善各种形式的连续交付所需的通用企业线程。当然，你不需要两个都有——但是话说回来，蝙蝠侠和罗宾在一起才是完美的。</p><h2>最后的想法</h2><p>至此，您应该对将 CD 和特性标志分开的高层次含义，以及为什么这样做没有意义有了相当好的理解。要明确的是:如果你不考虑一起使用 CD 或特性标志解决方案，你就错过了它们的全部价值。事实上，如果只使用其中一个而不使用另一个，你可能会给自己带来更多的麻烦。</p><p>Harness 在软件交付生命周期的每个阶段都会遇到您，无论是 CD、特性标志还是其他。如果你准备好了解我们是如何做我们所做的事情的，你可以注册<a href="https://app.harness.io/auth/#/signup/">永远免费</a>或者联系我们进行正式演示。</p></div></div>    
</body>
</html>