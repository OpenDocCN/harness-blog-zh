<html>
<head>
<title>Harness Extends Continuous Verification To Dynatrace | Harness</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>线束将连续验证扩展到Dynatrace |线束</h1>
<blockquote>原文：<a href="https://www.harness.io/blog/harness-extends-continuous-verification-dynatrace#0001-01-01">https://www.harness.io/blog/harness-extends-continuous-verification-dynatrace#0001-01-01</a></blockquote><div><p>将Harness与Dynatrace集成，并跨部署管道自动验证应用程序性能。通过我们的教程了解如何操作！</p><div fs-richtext-element="rich-text" class="blog-rtf w-richtext"><p>如今，客户在其开发、QA和生产环境中使用应用性能监控(APM)软件并不罕见。</p><p>几周前，一家大型FS企业客户评估了Harness for Continuous Delivery(CD)并表示:“我们需要尽快获得Dynatrace的支持。”</p><p>所以，几个星期后，通过API的力量，我们在这里。</p><h2>为什么用Harness + Dynatrace？</h2><p>Harness帮助客户掌握CD，以便他们能够快速自信地将新应用和服务部署到生产中。</p><p>Dynatrace帮助客户管理这些新应用和服务的性能。</p><p>对于每个应用程序/服务，客户通常有一个或多个部署管道。典型的管道有几个反映环境的阶段(如开发、质量保证、试运行、生产)，用于在生产部署前测试/验证代码。</p><p>现在，将Harness与Dynatrace集成后，客户可以自动验证其部署管道中的应用程序性能。</p><h2>简单的部署管道示例</h2><p>假设我们有一个名为“我的微服务”的Docker微服务，我们的持续集成(CI)工具Jenkins创建了一个新版本(#101)，为我们带来了一个新的工件版本。</p><p>利用Harness，我们可以获得新版本，并立即触发一个4阶段部署管道，如下所示:</p><figure class="w-richtext-figure-type- "/><p>每个管道阶段都将我们的新微服务部署到不同的环境中，运行一些测试，在进入下一阶段之前验证一切正常。</p><p>你可以从上面的截图中看到，第1到第3阶段(开发/质量保证)成功了，变成了绿色。这通常是好的，这意味着工件通过了所有的测试，并且已经为生产和客户做好了准备。</p><p>坏消息是，第四阶段:生产变红，我们的管道状态是“失败”。</p><h2>利用线束自动执行部署运行状况检查</h2><p>在Harness，我们将CD向前推进了一步，称为持续验证。</p><p>我们的早期客户之一，Build.com，曾经用5-6个团队领导手动分析监控数据和日志文件来验证生产部署。这个过程需要每个团队领导60分钟，每周进行3次。这相当于团队在验证上花费了1080分钟或18个小时的时间。借助Harness，Build.com将验证时间缩短至仅15分钟，并且<a href="https://harness.io/2018/01/how-build-com-automated-ci-cd-rollback/">使自动回滚能够在生产</a>中发生。</p><p>有了Dynatrace，Harness能够在每个环境中即时部署和验证工件的性能。一旦部署了新的工件，Harness将自动连接到Dynatrace，并开始分析应用程序/服务性能数据，以了解每个部署的实际业务影响。</p><p>Harness应用无监督的机器学习(隐马尔可夫模型和符号聚合表示)来了解关键业务交易的绩效是否偏离，并相应地标记绩效回归。</p><p>让我们看看用Dynatrace进行验证是什么样的。</p><h2>使用Dynatrace进行连续验证</h2><p>以下部署工作流与上述失败的管道相关，特别是生产阶段4。您可以看到canary部署的第一阶段成功了，但第二阶段失败了。升级集装箱的部署取得了成功，与Jenkins和ELK相关的验证和测试也取得了成功。但是，Dynatrace验证失败了，这意味着发现了新的性能退化。在这种情况下，最终的动作是自动回滚(这是Harness提供的安全网)。</p><figure class="w-richtext-figure-type- "/><p><br/>单击Dynatrace失败步骤(红色)向我们展示了验证失败的原因:</p><figure class="w-richtext-figure-type- "/><p><br/>我们可以看到，在部署了新的微服务版本后，一个关键业务事务“requestLogin”出现了响应时间性能回归。将鼠标悬停在红点上，我们可以获得更多详细信息——部署后，响应时间实际上增加了58%,从840毫秒增加到1330毫秒:</p><figure class="w-richtext-figure-type- "/><p><br/>该验证的默认时间段为15分钟，但该数字可以自定义。一些部署管道和工作流可能需要几个小时才能完成，因为并非所有事情都是自动化的(手动检查/批准等。).</p><h2>配置动态跟踪连续验证</h2><p>使用标准的Dynatrace API构建我们的集成非常简单。</p><p>你需要做的第一件事是<strong>设置&gt;连接器&gt;添加新的验证提供者</strong>:</p><figure class="w-richtext-figure-type- "/><p><br/>然后输入您的Dynatrace URL和API令牌详细信息:</p><figure class="w-richtext-figure-type- "/><p><br/>您可以从Dynatrace设置菜单中获取生成您的API令牌:</p><figure class="w-richtext-figure-type- "/><h2>将动态跟踪验证添加到部署工作流中</h2><p>首先，在Harness中添加或编辑现有工作流。只需点击<strong>添加验证</strong>并从菜单中选择Dynatrace。</p><figure class="w-richtext-figure-type- "/><p>接下来，选择您的Dynatrace连接器实例，并添加除了验证时间段(默认为15分钟)之外您想要验证的每个服务方法(关键业务事务)。</p><p><strong>注意:</strong>我们正在与Dynatrace团队合作<a href="https://www.dynatrace.com/support/help/dynatrace-api/" target="_blank">更新他们的API </a>，这样您只需选择一个应用程序或服务名称，它就会自动验证默认关联的所有关键业务交易。</p><figure class="w-richtext-figure-type- "/><p><br/>单击提交，您的部署工作流现在将使用Dynatrace自动验证应用程序性能。</p><h2>还会有更多</h2><p>正如你可能想象的那样，我们可以用Dynatrace做更多的事情。以下是未来几件值得期待的事情:</p><ul role="list"><li>Dynatrace用户的线束展开标记(右移)</li><li>在Dynatrace业务事务的上下文中利用向下钻取(右移)</li><li>支持Dynatrace日志非结构化事件数据(类似于我们的Splunk、ELK和Sumo逻辑支持)</li></ul><p>特别感谢我们的客户、工程团队和来自Dynatrace的<a href="https://twitter.com/grabnerandi" target="_blank"> Andreas Grabner </a>为我们提供支持。</p><p>干杯！<br/>史蒂夫。</p></div></div>    
</body>
</html>