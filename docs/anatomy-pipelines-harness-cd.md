# 线束 CD 管道剖析，第一部分|线束

> 原文：<https://www.harness.io/blog/anatomy-pipelines-harness-cd>

这篇博客将解释制作一张简单的 YAML CD 背后的过程。但首先，我们来学习一下 CD 术语。

在设计 Harness CD 的下一个迭代时，我们的核心焦点是让我们的完整管道对开发人员友好。建立一条贯穿 YAML 的完整的线束管道是朝着这一目标迈出的一步。事实上，我们采取了 **YAML 优先的方法**。这篇博客将解释制作一张简单的 YAML CD 背后的过程。

## **词汇表**

**什么是管道？**

管道是交付软件新版本的端到端过程。但是管道可以更多:管道可以是一个循环过程，包括集成、交付、操作、测试、部署、实时变化和监控。

**什么是组织和项目？**

利用组织(Orgs)允许您对具有相同目标的项目进行分组。例如，业务单位或部门的所有项目。

线束项目包含具有相同目标的线束管线、用户和资源。例如，一个项目可以代表一个业务单位、部门，或者仅仅是一个应用程序的开发项目。

您可以在我们的文档中了解更多关于 [Harness 的关键概念和定义](https://ngdocs.harness.io/article/hv2758ro4e-learn-harness-key-concepts#organizations_and_projects)。 

**什么是舞台？**

阶段是管道的一个子集，包含执行管道过程的一个主要部分的逻辑。阶段基于管道的不同里程碑，如构建、批准和交付。

什么是服务和服务定义？

服务从逻辑上代表您的微服务、无服务器功能和其他工作负载。

服务定义代表服务的真实工件、清单和变量。

什么是基础设施、基础设施定义和环境？

基础设施告诉您在哪里部署服务。它包含环境和基础设施定义。

环境从逻辑上代表了您的部署目标(QA、Prod 等)。

基础设施定义实际上代表了您的目标基础设施。它们是实际的集群、主机等。

通过分离环境和基础设施定义，您可以在多个阶段使用同一个环境，同时在每个阶段更改目标基础设施设置。

**什么是执行力？**

在执行部分，人们可以定义步骤，以便告诉如何将服务部署到所提供的基础设施。

**什么是步骤？**

步骤是阶段中的单个操作，就像运行 shell 脚本或 HTTP 调用一样。

**什么是连接器？**

连接器包含集成和使用第三方工具所需的信息。例如，连接您的 GitHub 帐户等。

## 亚姆

在学习了术语之后，让我们编写 YAML 来将一个公开可用的清单部署到 Kubernetes。

在 YAML 中，我们首先定义管道元数据:

*在上面的 YAML 中，我们给* ***管道*** *元素赋予名称和标识符，其中* ***标识符*** *在所有管道中是唯一的。除此之外，管道可以存在于项目之下，项目存在于组织之下。*

然后，我们添加一个阶段( **Deploy** )来执行管道中的部署操作。

现在，从开发人员的角度考虑:当您必须部署某个东西时，您会想到什么问题？

现在，将**服务**添加到您的 YAML 中，它将定义用于部署的工件和清单。在服务定义中，我们将使用 Kubernetes 的[公开清单](https://github.com/kubernetes/website/blob/master/content/en/examples/application/nginx-app.yaml)。

这里，我们定义了一个包含 nginx YAML 的清单，其中我们提供了文件路径、repoName 和 GitHub 连接器细节。

你可以在我们的文档中了解更多关于[创建不同类型的连接器](https://ngdocs.harness.io/article/zbhehjzsnv-connect-to-code-repo)。  

接下来，我们将把**基础设施**添加到 YAML，使用连接器、名称空间和 releaseName 定义 Kubernetes 集群细节。

最后，我们将添加**执行**部分，在这里我们将添加 Kubernetes 滚动部署步骤。这是一个标准的 [Kubernetes 滚动更新](https://kubernetes.io/docs/tutorials/kubernetes-basics/update/update-intro/)。

## 进一步阅读

你可以了解更多关于不同的[部署策略](https://ngdocs.harness.io/article/0zsf97lo3c-deployment-concepts)的信息。你也可以在我们的博客上找到更多关于蓝绿部署和金丝雀部署的基础知识。

瞧啊。管道已经完成，现在您可以高枕无忧地执行它了。

完整管道 YAML:[https://gist . github . com/archit-harness/7d 507d 603775725 c 671300290d 14 e 79 c](https://gist.github.com/archit-harness/7d507d603775725c671300290d14e79c)

请继续关注本系列的第二部分，在那里我们将告诉您更多关于其他概念的内容:输入集、失败策略、条件执行等等。与此同时，如果您有兴趣了解更多关于线束的知识，[今天就预订您的演示吧](https://harness.io/demo/)。