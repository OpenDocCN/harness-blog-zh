# 将线束策略作为代码引入，由 OPA | Harness 提供支持

> 原文：<https://www.harness.io/blog/harness-policy-as-code>

它就在这里:将策略作为代码来利用，帮助组织创建和实施关于部署、基础架构等的策略，在不牺牲合规性和标准的情况下提供开发速度。

我们很高兴宣布将利用策略作为代码，由开放策略代理(OPA)提供支持，这是一种集中式策略管理和规则服务，使企业能够集中定义和监控在所有交付管道和流程中实施的策略。将策略作为代码来管理有助于组织在部署、基础设施等方面创建和实施策略，在不牺牲合规性和标准的情况下提高开发速度。

将策略作为代码是基于 OPA 的，OPA 是一种易于使用、可扩展的解决方案，用于在整个堆栈中创建和实施策略。OPA 是一个被云本地计算基金会(CNCF)接受的开源项目，在众多软件交付用例中被广泛采用。策略是以声明性代码的形式编写的，因此它们易于理解和修改——从简单的用例到复杂的用例。

将策略作为代码与 CI、CD 和功能标志集成，强制执行自动批准、拒绝和其他高级管道功能。查看我们的[技术文档](https://ngdocs.harness.io/article/1d3lmhv4jl-harness-governance-overview#sort=relevancy&f:@commonsource=%5BNextGen%20Docs%5D)了解更多信息。

## 为什么我们需要软件交付中的策略管理

当 DevOps 在企业中被采用时，通常一个团队创建并维护软件交付和过程。该团队拥有完全的控制权和可见性，因为他们是公司内部开发运维流程的“创建者”。随着越来越多的业务单位在公司内部采用 DevOps，原始团队的手动过程会产生一个瓶颈，通过限制团队自治和减慢软件交付来阻碍创新。

为了消除瓶颈并提高速度，公司可以通过允许开发团队驱动他们自己的 DevOps 过程来给予他们更多的自主权。过程控制的分散化会给公司带来更多的风险。

当治理被分散时，开发团队可能会错过质量检查或批准，引入漏洞，或者违反法规。组织需要平衡自主性*和*治理，这样他们就可以让团队有信心遵守所有的合规性标准和安全策略，而不会减缓创新。

法规遵从性在受监管行业(如金融服务和医疗保健)变得更加重要，不仅是企业标准，还有第三方法规，如 SOC2、PCI 和 FedRamp。所有软件交付管道都必须满足完全可审计的合规标准；否则，该组织将面临审计失败、巨额罚款和声誉受损的风险。

跨 DevOps 流程的策略集中管理和治理允许企业为整个组织定义标准，同时强制遵守法规。策略使单个团队能够对他们的过程拥有自主权，并有适当的监督和保护，以防止他们偏离标准，确保安全和合规的软件交付。

## 将策略作为代码功能

利用策略作为代码是一种集中的策略管理和规则服务，它利用 OPA 来满足软件交付的合规性要求。HPE 使组织能够集中定义和监控跨所有交付渠道和流程实施的策略。

用于编写和实施策略的代码特性包括:

*   一个策略编辑器，使开发人员能够快速开始编写策略代码。有了一个策略库和一个测试终端，开发人员可以在启用策略之前，在开发过程中对实际输入进行试验。
*   配置为在线束流程上自动实施的策略(例如，在管道运行时、在功能标志保存时)。
*   设置严重性的能力，因此违反策略可以发出警告或抛出错误以阻止进程继续进行。
*   一种审计跟踪，可以维护策略评估的完整历史，并提供详细的审计和法规遵从性输出。

*Sample policies that can be customized.*

随着策略作为代码发布，现在可以在 CI 和 CD 管道以及功能标志上实施策略。

管道策略控制着交付管道的需求，当保存或触发管道时，甚至在管道执行过程中，可以自动实施管道策略。策略可以实施特定的管道配置、高级访问控制用例、运行时验证等。以下是策略作为代码可以做什么的一些示例:

*   在部署到生产之前需要一个批准步骤。
*   禁止在管道中使用外壳脚本。
*   仅允许部署到批准的命名空间。
*   仅允许来自批准的容器注册表的部署。
*   在允许管道继续之前，验证测试步骤结果是否满足最小阈值。

*A pipeline that could not be deployed due to policy noncompliance. *

当标志更新或切换开/关时，将强制实施功能标志的策略，从而启用符合标准、标志流程和卫生的策略。这包括:

*   仅允许创建布尔标志。
*   强制实施标志命名约定。
*   强制创建标志时，默认的开和关值必须都为假。
*   要求在 QA 中启用功能标志，然后才能在生产中启用。

策略即代码集中并标准化了跨软件交付的策略管理，允许工程领导者授权开发团队拥有他们的工具和实践，同时确保每个人都遵循公司的合规性和安全性标准。有了护栏，开发团队在编写管道时就不会引入安全漏洞。领导者可以放心地满足法规遵从性标准，对策略和失败进行全面审计，并且他们可以利用左移治理尽早发现和报告违规行为。

## 开始

查看我们的[平台治理页面](https://harness.io/products/platform/governance)以了解更多关于 Harness 软件交付治理的现代方法如何使团队拥有稳定的过程而不会减慢交付，或者[今天就请求您的个性化演示](https://harness.io/demo/)。