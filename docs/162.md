# Pivotal Cloud Foundry 的 CI/CD 管道|线束

> 原文：<https://www.harness.io/blog/ci-cd-piplines-for-pivotal-cloud-foundry>

什么是 Pivotal Cloud Foundry？了解如何使用 Harness 进行 PCF 部署。获取管道分析、实时工作流等信息！

自从我们脱离秘密行动以来，这已经是疯狂的 6 个月了。Harness 开发团队已经发展到 25 名工程师，我们的平台支持已经从 Linux、裸机、亚马逊网络服务(AWS)、谷歌云平台(GCP)和 Kubernetes 发展到新的平台/堆栈，如 Lambda、 [Helm](https://harness.io/blog/what-is-helm/) 、Azure Kubernetes Service (AKS)，以及现在的 [Pivotal Cloud Foundry](https://pivotal.io/platform) (PCF)。

虽然 AWS 无疑赢得了大多数人的投票，但 PCF 已经成为许多大型 F500 企业的战略平台和赌注。这是一个 Harness 想要打开的市场。

## 什么是 Pivotal Cloud Foundry？

请将 PCF 视为一个抽象平台，它位于您所有现有的云提供商和计算基础设施之间。不管你的云是公有还是私有，混合云对许多企业都有吸引力。

PCF 管理和抽象应用程序的所有运行时和基础设施依赖性。你基本上把你的应用程序部署到 PCF 平台上，Bob 是你的叔叔。它类似于开源平台 OpenShift，只是它更专注于传统的企业应用，而不仅仅是纯粹的基于容器的应用。

## 为什么要利用 PCF 的持续交付？

PCF 带有基本的部署功能；但是，以下功能是许多 PCF 客户选择利用 CD 即服务的原因:

*   **跨所有应用、服务和环境的部署管道分析&报告**。
*   **实时部署工作流**——团队实时观察和调试部署的能力。
*   **打包部署策略** -完全支持滚动、淡黄色和蓝/绿色部署。
*   **持续验证**——利用机器学习实现部署健康检查自动化的能力。
*   **自动回滚**——持续验证失败时，即时回滚的能力。

此外，Harness 提供了一种更专注于持续交付的方法，因此组织可以向内部开发和 DevOps 团队提供 CD 即服务。将 Harness 视为交钥匙解决方案，而不是工具包。

## 设置 PCF 的线束

您需要做的第一件事是将您的 PCF 帐户定义为 Harness 内部的云提供商。
为此，进入**设置>云提供商>添加云提供商**

接下来，输入您的 PCF 账户详情:

您可以选择在您的 PCF 集成/连接器上设置“使用限制”,以便只有某些应用、服务或环境可以使用此帐户。您还可以在 Harness 中定义许多 PCF 云提供商，这些提供商可以通过我们的[基于角色的访问控制](https://harness.io/blog/rbac/) (RBAC)进行控制。

## 构建您的第一个 PCF 部署管道

首先，您需要创建和定义您的 PCF 服务。将服务想象成您将部署到 PCF 空间(环境)的工件或包。

转到:**设置>我的 PCF 应用>添加服务**

接下来，输入您的服务的**名称**，并选择“ **Pivotal Cloud Foundry** ”作为您的工件类型:

接下来，**将您的工件存储库源**链接到您的新服务(如下)。这将确保 Harness 自动选择并控制工件/包的最新构建或版本。

一旦您的工件/包被链接到 Harness，下一步就是管理您的 PCF 服务的**清单文件**，此外还有您想要管理的任何**配置变量、秘密、**或**配置文件**。所有这些服务上下文都将由 Harness 控制版本，以便在需要时可以自动回滚到上一个工作版本。

一旦定义了您的服务，接下来您需要定义这些服务将被部署到的环境或 PCF 空间。

转到:**设置>我的 PCF 应用>环境>创建环境**

**为您的环境命名**并为每个服务**选择 PCF 作为您的部署类型**并**选择合适的 PCF 云提供商。**从这一点来看，Harness 将查询您的 PCF 帐户，并填充将定义您的环境基础架构的组织和空间。

最后，参考您的 PCF 路线图，以便对您的服务和环境的流量进行适当的管理。您甚至可以定义一个临时路线图，用于蓝/绿部署用例。

现在您的 PCF 服务和环境已经定义好了，您将能够像这样创建部署工作流和管道:

如果您想尝试连续送货服务，[请注册免费试用](https://harness.io/request-trial/)。

干杯！史蒂夫。@ BurtonSays 说