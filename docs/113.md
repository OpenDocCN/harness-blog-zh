# 部署脚本不是自动化|工具

> 原文：<https://www.harness.io/blog/deployment-scripting-not-automation>

用线束参数化部署管道——使部署、验证和回滚任务完全自动化和动态化。

在过去的一年里，我和世界上数百个团队讨论了持续交付。我还观察了 50 多个不同的部署过程，客户都很友好地向我展示了他们当前的方法和工具。

现在，我有争议的重磅炸弹来了:**部署脚本不是自动化。**
让我们首先提醒自己自动化实际上意味着什么:

**自动化**可以定义为在没有人工协助的情况下执行流程或程序的技术。 [^(【维基】)](https://en.wikipedia.org/wiki/Automation#cite_note-1)

记住，维基百科永远不会出错。

## 黄金部署日

部署脚本通常适用于简单、小型和静态的应用程序。

早在 2005 年，使用 shell 脚本对应用程序/服务的所有不同组件和依赖项进行建模、映射和管理是一件相对简单的事情。您可以硬编码这些主机名、环境变量和包依赖项，生活通常是美好的...../startWeblogic.sh

2018 年，事情有点不一样了。云原生应用不是静态的、小的和简单的。您有多个技术栈、数百个服务依赖项和不可变的基础设施。变化是不断的，这意味着您的自动化部署脚本需要比一个两岁的小孩更多的关注。

**底线:**在 2018 年，没有任何关于编写或维护部署脚本的自动化。

## 一些现实生活中的例子

下面是 3 个简单的例子，展示了通过部署脚本生存(和死亡)的客户的生活:

**客户#1** - 23 个部署脚本，由 15 名不同的工程师维护了多年。一些工程师已经不在公司了，而一些脚本包含零注释或文档。典型的部署需要 10 个人，分布在开发运维、部署、开发团队领导和工程师之间。当部署失败时(这种情况经常发生)，回滚需要 2 小时，调试和了解发生了什么需要 2-3 天。因此，部署每六周进行一次。

**客户#2** -由 4 名专业工程师组成的 DevOps 团队在其现有 CI 平台(Jenkins)之上维护部署脚本和插件。开发团队编写了他们自己的部署管道脚本来编排可用的部署脚本/插件库。当一个部署脚本或插件失败时，它会对所有开发团队管道产生影响。运行状况检查和回滚是手动的，需要 30 分钟到 1 小时，并且需要多达 5 名工程师进行故障排除。

**客户#3** -一个集中的部署团队维护着 10 多个部署脚本，这些脚本是手动连续执行的。他们中的许多人需要手工输入，比如各种服务工件的主要和次要构建版本、环境参数和标志。3-4 名工程师通过跟踪日志和在生产控制台之间切换上下文来观察每次部署。运行状况检查通常是凭直觉进行的，回滚是最后的手段，需要几个小时来完成和验证。

上面的三个例子并没有准确地描绘出自动化的图景——更像是混乱和屠杀。
不仅仅是部署过程本身；它是对底层部署脚本的不断调整、修补和维护。这些脚本中的大多数都不是动态的，或者对 2018 年应用程序代码或基础架构中发生的事情没有变化容忍度。

## 部署脚本！=连续交货

的确，您可以用 shell 脚本构建任何东西，就像您可以用木头、钉子和锤子构建任何东西一样。如果您的业务目标是竞争和缩短上市时间，那么部署脚本可能不是答案。

持续交付的一些规则:

*   任何人都可以部署
*   快速频繁的部署
*   一致、可重复且安全的部署
*   开发新的创新与保持旧的创新

使用部署脚本:

*   不是每个人都能部署。如果你的脚本失败了，那么你需要作者来调试发生了什么。
*   部署是手动编排的，并且需要手动输入，这增加了部署时间并降低了频率。
*   您的部署通常是跨应用/服务的临时部署，并且随着这些实体的发展和变化而不可预测，这导致了失败。
*   您花在更新部署脚本上的时间几乎和您的应用/服务本身一样多。

上周，我接到一家大型云存储供应商的电话，他们有 4 名全职工程师专门负责部署脚本。他们现在有一个活动的项目来完全自动化这个团队，以完全接受连续交付。

幸运的是，今天跨云、技术栈和工具的 API 已经相对成熟。可以将部署管道的输入(例如工件)参数化，并使实际的部署、验证和回滚任务完全自动化和动态化。动态意味着部署可以适应应用和基础架构的底层变化。

在 Harness，我们称之为“智能自动化”——你可以注册你的[免费试用](https://app.harness.io/auth/#/signup)。

干杯，
史蒂夫。@ BurtonSays 说