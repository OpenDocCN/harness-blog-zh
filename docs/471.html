<html>
<head>
<title>CloudFormation and Terraform - Adding Infrastructure Provisioners | Harness</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>云形成和地形形成-添加基础架构供应器|线束</h1>
<blockquote>原文：<a href="https://www.harness.io/blog/cloudformation-and-terraform-support#0001-01-01">https://www.harness.io/blog/cloudformation-and-terraform-support#0001-01-01</a></blockquote><div><p>你使用CloudFormation和Terraform脚本/模板吗？Harness在我们的部署管道模型中引入了基础设施供应器。</p><div fs-richtext-element="rich-text" class="blog-rtf w-richtext"><p>基础架构供应器对于云原生应用和环境来说是一件大事。自动化基础架构的配置和停用使您能够即时扩展和缩减，同时获得按需计算的成本优势。</p><p>通过将此流程集成到所有环境的部署管道中，您可以有效地扩展端到端自动化，并为所有开发和工程团队获得成本优势。</p><p>例如，仅当新的构建或版本存在或需要测试时，才启动开发、QA和准备<a href="https://harness.io/blog/deployment-environments/" target="_blank">环境</a>。当您需要复制生产时，您还可以使用它们进行快速<a href="https://harness.io/blog/blue-green-canary-deployment-strategies/" target="_blank">蓝绿</a>部署。</p><p>在过去的一年里，我们不断从客户那里听到AWS CloudFormation和HashiCorp Terraform是新的标准；因此，与Harness软件交付平台的集成是“不需要动脑筋的”</p><h2>什么是AWS CloudFormation？</h2><p><a href="https://aws.amazon.com/cloudformation/" target="_blank">AWS cloud information</a>为您提供了一种通用语言来描述和调配云环境中的所有基础架构资源。</p><p>CloudFormation允许您使用一个简单的文本文件，以自动化和安全的方式，跨所有地区和客户对您的应用程序所需的所有资源进行建模和供应。该文件是您的云环境的唯一真实来源。</p><h2>什么是HashiCorp Terraform？</h2><p><a href="https://www.terraform.io/" target="_blank"> HashiCorp Terraform </a>使您能够安全、可预测地创建、更改和改善基础设施。它是一个开源工具，将API编译成声明性的配置文件，可以在团队成员之间共享，作为代码处理，编辑，审查和版本控制。</p><p>Terraform类似于AWS CloudFormation，但它是多云的——这意味着它是定义跨AWS、Azure、GCP等基础设施的通用语言。</p><h2>引入线束“基础供应器”</h2><p>为了适应CloudFormation和Terraform脚本/模板，我们在部署管道模型中引入了一个名为“基础设施供应器”的新概念:<br/></p><figure class="w-richtext-figure-type- "/><p><br/>可以将基础架构供应器添加到任何部署工作流中，以便在部署过程中供应和停用基础架构(云集群)(如果需要)。</p><p>其理念是，您可以跨部署工作流和管道轻松地重用、管理、调试和编排CloudFormation和Terraform脚本/模板。您的基础架构与应用程序级别上发生的事情保持同步。</p><h2>创建基础架构置备程序</h2><p>进入<strong>设置&gt;你的应用&gt;基础设施提供者</strong> <br/>点击<strong> +添加基础设施提供者</strong>，选择<strong>地形</strong>或<strong>云形成。</strong></p><figure class="w-richtext-figure-type- "/><p><br/>接下来，添加您的脚本/模板的主体，或者通过源类型下拉菜单简单地引用它:</p><figure class="w-richtext-figure-type- "/><p><br/>您可以通过按下<strong>从模板</strong>控件填充来自动解析来自脚本/模板的输入变量，或者您可以使用<strong> +Add </strong>控件手动创建它们。</p><p>接下来，您需要将每个基础设施供应器映射到一个或多个服务(工件)。点击<strong>添加服务映射</strong>，选择需要的服务、部署类型和云账户。然后，您可以使用$前缀指定适当的集群配置，作为文本或变量；这基本上允许您将参数从CF/Terraform传递到线束工作流程&amp;环境中。</p><figure class="w-richtext-figure-type- "/><p><br/>您的基础架构供应器设置现已完成:</p><figure class="w-richtext-figure-type- "/><h2>向部署工作流添加基础架构设置程序</h2><p>一旦定义了基础架构供应器，现在就可以在任何部署工作流中添加和引用它们。</p><p>例如，下面是一个简单的canary部署工作流，分为三个阶段。</p><p>我们可以通过在工作流程中添加<strong>预部署步骤</strong>来轻松添加/引用我们的CloudFormation或Terraform脚本/模板:</p><figure class="w-richtext-figure-type- "/><p><br/>该控件显示以下对话框，我们可以在其中将CF/TF infra provisioner添加到工作流中:</p><figure class="w-richtext-figure-type- "/><p><br/>现在，除了脚本/模板变量之外，您还可以使用相关的云提供商详细信息实例化您的CF/TF脚本/模板，这些变量可以是带文字的静态变量，也可以是带参数的动态变量。<br/></p><figure class="w-richtext-figure-type- "/><p>添加后，您的工作流将如下所示，显示您的<strong>基础配置程序</strong>将在部署阶段之前执行:</p><figure class="w-richtext-figure-type- "/><p><br/>如果您也想使用CF/TF来淘汰基础设施，您也可以将其作为<strong>部署后步骤</strong>。</p><h2>调试云形成和地形部署</h2><p>现在，当您执行管道或部署工作流时，您将在部署上下文中看到所有CloudFormation和Terraform控制台输出。这对于调试和管理任何基础架构供应问题非常有用:</p><figure class="w-richtext-figure-type- "/><p>我们努力让客户尽可能简单、轻松地将CloudFormation和Terraform集成到他们的部署管道中！</p><p>这里有一个两分钟的视频展示了这有多简单:<br/></p><figure class="w-richtext-align-center w-richtext-figure-type-image"/><p>您可以从Harness软件交付平台的<a href="https://app.harness.io/auth/#/signup" target="_blank">免费试用版</a>开始。<br/>干杯，<br/>史蒂夫。@ BurtonSays说</p></div></div>    
</body>
</html>