# 一次开发体验——构建、部署和试验:CI/CD | Harness 中的期望和体验

> 原文：<https://www.harness.io/blog/dx-expectations-experiences-cicd>

在本电子书摘录中，我们回顾了对软件工程师和 DevOps 团队的期望，以及如何在 CI/CD 中提供最好的 DX。

如果你的软件对其他人或其他东西不可用，你的软件甚至是一个软件吗？尽管这是一个比喻，但作为一名软件工程师，在本地机器上构建自己的东西对任何人都没有好处。最简单的形式是，您需要构建、测试和部署您的变更。

本文摘自我们的电子书《一个开发者的体验——构建、部署和实验》。如果你喜欢你看到的内容，坚持到最后，我们会为你链接完整的电子书。它是免费的——最棒的是，没有栅门。

你的想法在到达用户手中之前可以跨越许多环境和基础设施。即使将安全性考虑在内，您也可能必须导航发布策略，例如 canary 发布，以增量方式更新正在运行的系统。随着越来越多的项目转向开发人员，扩展的知识量，例如基础设施自动化和 DevSecOps 实践，可能很难学习。

由于持续集成和持续交付方面的进步，您的更改可以安全地构建、打包、测试和部署到新的或现有的基础架构中。自动化和专业知识可以放入 CI/CD 渠道和其他渠道，以帮助进一步发展和实现 DX 目标。更完整的生产之旅可以看起来像下面的旅程；获得一个可部署的工件并部署它。

从代码到工件的过程可能如下图所示:

虽然拥有藏物只是旅程的一部分。在现代软件交付中，需要协调建立信任的步骤和安全性。自动化是一致性和良好开发人员体验的关键。高度自动化的生产部署可能如下所示(利用 canary 版本):

## 对现代软件工程师的期望

总的来说，工程师是天生的优化者。提高工作效率的能力非常重要。由于诸如敏捷这样的增量开发实践的兴起，工作的速度和对特性的需求可能是无限的。软件的唯一限制是时间和资源。

软件工程师也很自然地倾向于更好的工艺和需要不断学习的领域。如前一节所述，一些范例继续向开发人员左移，例如 DevSecOps 运动带来的安全性和 Kubernetes 带来的应用程序基础设施自动化。工程负担持续增加。

现代软件工程师期待一个好的 DX。为了提高工作效率，软件工程师需要对抗不断增长的加速时间的趋势，通过以创新的步伐构建和部署，他们可以更快地看到自己的劳动成果，从而获得满足感。

## 构建软件/持续集成时的最佳 DX

在开发人员的开发环境之外扩展积极的本地构建体验确实需要思考。持续集成是构建自动化，关注构建的外部化。然而，不仅仅是编译的源代码可以进入构建；持续集成的最终产品是一个候选版本。

工程效率的一个核心原则是满足你的内部客户。对于软件工程师来说，这就是尽可能地接近他们的工具和项目。像许多现代的应用程序基础设施一样，向开发人员转移意味着被包含在源代码管理(SCM)的项目结构中。

随着构建速度的提高，以符合“每一次提交都应该触发一次构建”的口号，开发团队可能每个团队成员每天都会生成几个构建，甚至更多。与传统的应用程序打包相比，生产现代容器化版本所需的火力已经增加了。

通常，一个组织以可重复和一致的方式运行自动化测试的第一次尝试最终会在他们的持续集成管道中结束。通常，这是一个容易的电梯；开发人员在本地构建中遇到的相同代码/测试覆盖进入了构建管道，因为这些步骤应该在提交之前执行。

一个常见的分布式系统谬误是一个人了解整个系统的端到端。这不是真的。当添加新特性或扩展测试覆盖范围时，我们很容易陷入泥巴模式，无论是在开发还是测试方面。测试套件的执行时间和复杂性可能会随着每个新的变化而增加。通过以智能的方式运行测试，并且只执行对新变化谨慎的测试，这显著地对抗了测试覆盖的复杂性。

以智能的方式显示通过执行测试覆盖节省的时间:

通过对覆盖率和变更进行建模来帮助确定适当的测试覆盖率:

## 部署软件/连续交付时的最佳 DX

构建软件通常是按照惯例完成的，但是部署软件可能是非常定制的。软件是您在项目或产品团队工作之前、期间以及可能之后的决策的顶点。导航所有的应用和基础设施选择，尤其是在有用户流量的实时系统上，对于每个团队来说都是复杂且独特的。

将增量变更部署到开发集成环境中通常是面向 DX 的，因为开发人员可以完全控制环境。尽管随着向生产进军的继续，某些组织可能会受到不允许开发人员参与生产的业务控制。这就是持续交付的切入点。

Jez Humble 对持续交付的定义是:

连续交付是以可持续的方式安全、快速地将所有类型的变更(包括新功能、配置变更、错误修复和实验)投入生产或交付给用户的能力。

*安全意味着管道执行质量、测试和处理故障的机制。快速意味着管道在没有人工干预的情况下以自动化的方式提升代码，最后，可持续意味着管道可以用较少的努力和资源一致地实现所有这些。*

好的交付是快速且可重复的，好的管道是快速、安全且可重复的。《加速》一书指出，精英执行者的交付周期不到 1 小时，生产部署的变更失败率不到 15%。因此，一个好的管道将在一个小时内完成，并在代码到达最终用户之前捕获 95%的异常和回归。

如果您的代码需要一个多小时才能到达生产环境，或者如果 10 个部署中有 2 个以上失败，您可能需要重新考虑您的管道设计和策略。因为实验需要迭代，如果需要全天进行，那么全力以赴的部署可能太冗长，无法进行有针对性的更改或实验。实验在下一代 DX 中很重要。

## 结论

我们希望您喜欢我们的 One Developer Experience 电子书的节选。在下一段摘录中，我们将回顾实验对 DX 的重要性。如果你不想等待下一篇文章，那么今天就下载 DX 电子书吧——它是免费的，不需要电子邮件地址:[一次开发者体验](https://harness.io/learn/ebooks/ebook-one-developer-experience/)。