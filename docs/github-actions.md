# 什么是 GItHub Actions？功能、评论、定价及更多|利用

> 原文：<https://www.harness.io/blog/github-actions>

如果你想知道 GitHub Actions 是什么，它如何帮助你进行软件交付，我们创建了这个介绍和指南来帮助你。

如果你想知道 GitHub Actions 是什么，它如何帮助你进行软件交付，我们创建了这个介绍和指南来帮助你。

## 什么是 GitHub Actions？

GitHub Actions 是一个持续集成和持续交付(CI/CD)平台。它使用户能够自动化各种 GitHub 事件，比如克隆存储库、生成 Docker 映像和测试脚本。它将通过 GitHub 事件启动工作流，如推送、问题创建或新版本。例如，您可以创建一个工作流程，以便每当有人在您的存储库中创建新问题时，自动运行该工作流程来添加适当的标签；或者您可以开发一个工作流程，以便每当有人开始一个或多个作业时，设置环境变量。

在我们深入 GitHub 操作之前，如果您需要更多关于 CI/CD 的介绍性信息，以及这个主题如何适应软件开发实践，请查看我们的博客，解释[什么是 CI/CD](https://harness.io/blog/devops/what-is-ci-cd/) 您可能也有兴趣阅读更多关于[什么是持续集成](https://harness.io/blog/continuous-integration/what-is-continuous-integration/)以及 CI 的[好处。](https://harness.io/blog/continuous-integration/benefits-of-ci/)

## GitHub 操作功能

GitHub Actions 使您所有软件工作流程的自动化变得容易，因此您可以直接从 GitHub 构建、测试和部署您的代码。GitHub 动作特性包括:

### 基于 YAML 文件的工作流

为了使用 GitHub 动作自动化开发工作流，用户使用工作流文件或 YAML 文件创建定义，并将这些文件存储在 GitHub 存储库中的。github/workflows 目录。工作流运行有三种触发方式:通过外部事件、预定事件或 GitHub 存储库事件(如对 GitHub 存储库或问题创建的 push 或 pull 请求)。

### 机密管理

GitHub Actions 提供了不同的方法来确定机密的范围:

*   可以在全球组织范围内设置机密
*   不必在多个 Git 存储库中更新机密，它们可以在一个集中的地方进行处理
*   还可以限制秘密是否暴露给分叉的存储库

### 适用于 Linux、MacOS、Windows、ARM 和容器的托管运行程序

如果你想使用 GitHub 托管运行器，GitHub Actions 包含了多个操作系统的托管运行器，因此用户可以构建和测试各种各样的项目。GitHub Actions 运行在一个 VM 上或者一个容器内部。在云中或本地的虚拟机上的虚拟环境中托管您自己的跑步者是可能的。

### 作为 SaaS 和内部提供

GitHub Actions 过去只面向 SaaS，但该公司在 GitHub Enterprise Server 3.0 或更高版本上为客户添加了一个本地版本。最新版本在您选择的操作系统上或数据中心环境中运行。根据我们的理解，虽然有一些小的限制，但是大多数操作都可以在本地版本上用于多种操作系统。

### 广泛的语言支持

GitHub Actions 支持 Node.js，Python，Java，Ruby，PHP，Go，Rust，。NET 等等。用户可以在任何操作系统上用自己选择的语言构建、测试和部署应用程序。

### 矩阵构建

利用 matrix 工作流节省时间，该工作流可跨多个操作系统和运行时版本同时进行测试。

### 多容器测试

通过将一些 docker-compose 添加到工作流文件或 YAML 文件(YAML 文件扩展名是),在工作流运行中测试您的 web 服务及其数据库。yml)。

### 实时日志

用户可以在 GitHub Actions 中看到他们的工作流实时运行。只需点击一下，即可复制突出显示特定行号的链接，以共享 CI/CD 故障。

### Dockerfile 文件支持

GitHub 动作有 Dockerfile 支持。GitHub Actions 可以将工件发布到 GitHub 包或另一个包托管提供者，如 Docker Hub。用户还可以利用其他开发人员构建的操作。例如，有一个名为 Check Ansible Ubuntu latest 的操作可以让您在 Docker 容器中测试您的 Ansible 角色或剧本。

## GitHub 操作定价

很多用户疑惑，GitHub Actions 是免费的吗？GitHub Actions 对公共库是免费的，但是私有库的运行时间有 2000 分钟的限制。付费计划提供更多的通话时间。如果客户超出了计划的分配分钟数，他们将根据跑步者平台按分钟计费。自托管 runners 是免费的，在 GitHub Enterprise 自托管版本中也提供了 CI/CD 功能。

根据 GitHub 网站，GitHub Actions CI 定价如下:

> *“GitHub Actions 对公共存储库中的标准 GitHub 托管跑步者和自托管跑步者是免费的。对于私有存储库，每个 GitHub 帐户都会收到一定数量的免费分钟数和存储空间，供 GitHub 托管的跑步者使用，这取决于该帐户使用的产品。超出所含金额的任何使用都受支出限额控制。*

> *如果您是按月付费的客户，您的帐户将有一个 0 美元(USD)的默认消费限额，这可以防止超出您的帐户金额的私人存储库的额外分钟数或存储空间的使用。如果您通过发票支付您的帐户，您的帐户将有一个无限的默认消费限额。*

> *分钟数每月重置，而存储使用量则不会。"*

## GitHub 行动回顾:利弊

GitHub Actions 提供了潜在用户在迁移到 GitHub Actions 之前应该了解的优点和缺点。

### **易用性**

无论使用什么操作系统，用户都可以相当快地启动并运行 GitHub Actions。假设用户已经有了一个 GitHub repo，可以将第一个工作流添加到 repo 中并运行一个操作。然后，您可以快速运行您的第一个工作流。如果选择“自己设置工作流”选项，GitHub 会创建一个 main.yml 文件，其中包含。github/workflows 目录，其中包含您可以编辑的模板化工作流运行。

管理秘密是没有痛苦的:用户可以在组织级别以及回购级别设置秘密，这是相对灵活的。

一个更大的症结是数据在工作流之间传递的方式。这一开始可能有点棘手，肯定有一个学习曲线。当试图在动作和作业之间传递数据时，您会发现自己需要使用神秘的动作语法或 direct。env 文件插入，将每个作业的状态链接在一起。

像大多数 CI/CD 提供者一样，Github Actions 有第三方操作，您可以将其用作半即插即用功能。一个任务是否已经被一个公开的 GitHub 操作解决，这可能是命中或错过的——否则，您需要自己编写。考虑到这一点，您会发现自己在使用 GitHub 操作时需要编写大量代码。

最后，由于 GitHub Actions 是一个相对较新的产品，它仍然没有任何好的报告和对给定回购之外发生的事情的监督。没有用时间线或本机部署跟踪来观察执行的高级概述，这是 Harness 提供给你的。

### 有限自助服务

GitHub Actions 将基于您的存储库中的编程语言和框架推荐 CI 工作流，这很好，但远非真正的自助服务体验，尤其是如果您使用不同于 GitHub 的软件配置管理(SCM)工具。不知道配置管理是有好处的，因为 GitHub Actions 可以很好地监听发生在 GitHub 配置管理中的事件，而不是你选择的配置管理工具。用 GitHub Actions 进行测试并没有超出对创建的 pull 请求提供测试结果的范围。

### 缺乏连续验证功能

持续验证是在部署后监控应用程序异常的过程。

例如，持续验证可以发现延迟问题或 5xx 错误，并自动将应用回滚到以前的版本。持续验证的概念是尽可能快地捕捉错误——理想情况下，在客户注意到之前——并无缝转换回应用程序的前一版本。

GitHub marketplace 中有一些 GitHub 操作的基本部署状态操作，但这些操作只能告诉您部署是否通过/失败，而不能告诉您部署后的情况。

似乎要完全了解部署，您需要在 GitHub Actions 中编写自己的操作来实现这一点。有集成到一些可观察性工具，如 Lightstep，所以这是可以做到的-但必须使用 GitHub API 手动完成。

### 需要手动编写脚本

不幸的是，GitHub Actions 确实需要大量的脚本。好的一面是，如果您确实需要编写一个动作，您可以将它发布为一个容器图像，这样您就可以用您想要的任何语言来编写它。

GitHub marketplace 上也有一些预先编写好的动作，包括与大量工具的集成。预先编写的操作的一个例子是管理工作流运行的操作，它将检查相同的工作流是否已经从先前的提交开始运行，如果是，则等待它完成

然而，坏的一面是，虽然编写脚本并不是花费我们时间的最糟糕的方式，但它是可以用来发布代码的时间。这是辛劳。这需要你最聪明的工程师来维护，最终会占用宝贵的编码时间。

### 金丝雀部署可能具有挑战性

一位 Azure 用户整理了一份有用的[教程](https://blog.baeke.info/2021/01/11/kubernetes-canary-deployments-with-github-actions/)，讲述如何使用 GitHub Actions 和 Azure 通过 Linkerd 进行金丝雀部署。这是可能的，但正如用户所说，“在更复杂的生产应用程序中，完全自动化并基于指标的端到端解决方案非常具有挑战性。[……]虽然我认为 GitHub 动作运行良好，但我不赞成从 GitHub、Azure DevOps 和类似的解决方案中驱动所有这些。没有足够的控制力。”

“你能做并不意味着你应该做”这句谚语在这里仍然适用。

### 机密管理的局限性

GitHub Actions 没有针对机密管理的细粒度访问控制机制。此外，GitHub 操作中的秘密是为 CI/CD 本机处理的——不能利用第三方，如 HashiCorp Vault。

### 缺少本机指标仪表板

软件开发有四个关键指标:

1.  交付周期，或者说从代码被签入版本控制系统到它被部署到生产环境所花费的平均时间
2.  部署频率，即在一段时间内部署到生产的次数
3.  平均恢复时间(MTTR)或解决或回滚生产中的问题所需的时间
4.  变更失败率，即生产变更失败的百分比

这些指标是真正理解性能的核心概念之一。然而，GitHub Actions 不提供本机指标仪表板。

这就结束了我们对 GitHub Actions 的回顾。如果你正在寻找更多关于[最佳持续集成工具](https://harness.io/blog/continuous-integration/continuous-integration-tools/)的信息，我们有一个方便的指南。
寻找真 CI/CD？

如果您正在考虑将 CI/CD 解决方案添加到您的软件开发实践中，Harness 将集成并编排您的整个软件堆栈。而且，它使用 AI/ML 来自动化和加速您的软件交付。

‍ [今天免费试用安全带](https://app.harness.io/auth/#/signup)。