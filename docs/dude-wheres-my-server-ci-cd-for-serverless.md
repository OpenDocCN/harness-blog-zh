# 伙计，我的服务器呢？无服务器|线束的 CI/CD

> 原文：<https://www.harness.io/blog/dude-wheres-my-server-ci-cd-for-serverless>

近年来，无服务器基础架构越来越受欢迎，这带来了下一代适合每个用户请求的规模合适的基础架构。对于用户请求，无服务器函数调用通常是 1:1 的。尽管近年来由于像[阶跃函数](https://aws.amazon.com/step-functions/)这样的技术，这可以是 1:多。随着无服务器技术的蓬勃发展，对我们管道的依赖变得更加重要。

## 无服务器的兴起

对于软件工程师来说，构建业务逻辑通常只是等式的一半。另一半是导航应用基础设施。在 Java 世界中，调优应用服务器/Java 运行时并不罕见。了解您的应用程序在做什么与在哪里/什么东西在运行应用程序一样重要。运行应用程序的另一半是从软件工程师努力争取的核心创新工作中抽走的。想象一个范例，在这个范例中，您可以只关注功能或业务逻辑，而不必太担心您的应用程序在哪里运行，或者甚至扩展功能。你并不孤单，因此无服务器的繁荣正在进行中。无服务器功能的好处是，如果 Docker 映像需要几十秒钟才能变成运行中的容器，那么无服务器调用只需不到几秒钟。当该功能完成时，资源应该返回到可用的资源池中，以便再次启动。

## 不仅仅是λ

那些以任何粗略的谷歌搜索开始他们的无服务器之旅的人将会遇到亚马逊的 Lambda。亚马逊在 2014 年 11 月推出了其 [Lambda 服务](https://aws.amazon.com/lambda/)，对大多数人来说，它向大众介绍了无服务器服务。AWS Lambda 有几种替代方案，主要的云供应商都提供功能服务。值得一提的是 [Apache OpenWhisk](https://openwhisk.apache.org/) ，以及最近 [Google KNative](https://cloud.google.com/knative/) ，它公开了一个 Kubernetes 和 Istio 堆栈，工作量一直在增加。随着组织寻求提供现代开发人员所需的基础架构，无服务器基础架构也逐渐成为平台即服务产品。无服务器功能通常遵循触发、执行、输出模型。触发器将指示功能预热的开始时间，并执行工程师要求的所有魔术。在函数执行结束时，会创建某种输出，它位于内存中或保存在某个地方。

## 给我无服务器还是给我死亡？

如果我们能够成功地将应用程序分解成触发、执行和输出模型，我们就可以告别复杂性了。要是生活如此简单就好了；真空中很少有无服务器功能。组织可能会转移或构建更新的工作负载，并拥有无服务器组件。最终，将需要状态，因此服务器重新出现。因为从技术角度来看，与更传统的方法相比，部署和触发一个功能的开销较低，迭代次数往往会更多。迭代是软件世界创新的诞生；我们从来不会第一次就把事情做对。随着快速的交互，我们可能开始引入越来越小的变化，这在理论上会建立对功能的信心。当我们放弃白旗，开始接受工作量的时候，我们需要小心，不要走捷径，否则会害了我们。但是，对于任何技术，如果您还没有尝试过您自己的无服务器部署，那么入门是很简单的。

## 何时无服务器？

如果你以前没有写过 Lambda， [FreecodeCamp](https://www.freecodecamp.org/) 有一个创建 [NodeJS Lambda](https://www.freecodecamp.org/news/going-serverless-how-to-run-your-first-aws-lambda-function-in-the-cloud-d866a9b51536/) 的最好的教程。在他们的例子中，他们从头到尾遍历了一个 Lambda 函数的回文。随着基础知识的消失，现在无服务器函数是“*永不奇数或偶数*”(看我在那里做了什么，回文！)，就像 Linux 容器(又名 Docker)一样，在无服务器环境中重新编写整个应用程序堆栈并不能解决所有问题。Hackernoon 有一篇我所见过的关于一家公司在生产中使用 AWS Lambda 进行完全无服务器迁移的技术优势的最佳文章。作者经历了比 Linux 容器更短的生命周期和更短暂的工作负载。基本上，在我们的触发-执行-输出等式中，这是一场响应(即输出)的竞赛。Hackernoon 文章中的作者也谈到了平衡冷启动；这是函数预热开始执行所需的时间。应用程序容器(也称为 Lambda 容器)可能可以快速开始执行，但当您开始对依赖项进行分层时，尤其是如果需要与外部源(例如[Redis](https://redis.io/)/[Memcached](https://memcached.org/)集群)进行通信/保持时，您的体验会变得更糟。成本也是一个不容忽视的因素。一篇优秀的[中文章](https://medium.com/@zackbloom/serverless-pricing-and-costs-aws-lambda-and-lambda-edge-169bfb58db75)展示了 Lambda 成本计算的复杂性。Lambda 本身的成本与执行次数+数据传输+计算时间有关。随着 AWS 服务开始堆积，CDN、APIGateway、存储等功能的成本可能会上升。没有必要烦恼，开始破解，但不要忘记我们的朋友 SDLC 更多的采用。

## 不要忘记 SDLC！

通过这种快速的方式，您可以看到自己的辛勤工作创造出正在执行的下一代逻辑，很容易忘记我们的 SDLC 规程。无服务器基础设施的魅力和深度在于低开销和快速变化。区分初级和高级软件工程师的格言是知道哪里粗糙/哪里可能出错。通过系统地建立对功能的信心(例如测试和代码覆盖)来编写非无服务器基础设施的严谨性应该成为你的部署管道的一部分。诚然，应用程序基础架构的供应部分来得更快，而且如果设计得当，会更加灵活。虽然这个速度将测试你现有的或潜在的新管道。因此，在这种新的无服务器计算模式中，您的管道变得更加重要。

## 从零(或更多)到无服务器英雄

好奇从哪里开始如何将 Lambda 作为应用程序堆栈的一部分，或者如何增强 Lambda 部署的信心？只看马具。利用 Harness，将 Lambda 作为管道的一部分很简单。我们制作了一个[快速视频](https://www.youtube.com/watch?v=1flRydLex14),概述了将 Lambda 作为您管道的一部分的步骤。我们在[的文档](https://developer.harness.io/docs/first-gen/first-gen-quickstarts/aws-lambda-deployments/)中也对 Lambdas 进行了更深入的探究。*《为一罐红朗姆酒杀人》*？嗯，现在你不必使用我们的社区版，它是永远免费的。今天就加入我们的[社区](https://community.harness.io/)！拉维