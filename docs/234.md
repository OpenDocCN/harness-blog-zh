# “我喜欢在云成本上花钱”——从来没有人说过

> 原文：<https://www.harness.io/blog/i-love-spending-money-on-cloud-costs>

在 Harness，我们了解所有关于云成本的信息——我们也了解像我们这样规模的商店，如果我们仔细看看我们的支出，可以节省多少成本。这足以让史矛革感到一阵嫉妒——在这种情况下，史矛革就是谷歌云。

这是一个关于一家小公司如何在云成本上节省了一船现金的故事。

在 Harness，我们了解所有关于云成本的信息——我们也了解像我们这样规模的商店，如果我们仔细看看我们的支出，可以节省多少成本。这足以让史矛革感到一阵嫉妒——在这种情况下，史矛革就是谷歌云。

当我们经历这些时，没有“简单的按钮”(提示:[云成本管理](https://harness.io/platform/cloud-cost-management/))。这是一个团队的努力，包括从首席财务官到工程师的每一个人。我们很高兴向您介绍我们为节省 40%的云成本所做的工作。是的，你没看错: **40%** 。

## 我们是怎么坚持到*这个人*的？

我们的 CFO 过去一直肩负着管理云成本的责任，但这一过程太慢且过于被动。这并不是要责怪首席财务官，这只是自上而下管理云成本的正常副作用。

在思考了这个问题之后，我们决定，嘿，让我们自己的工程师拥有成本可见性不是更有意义吗？是的，是的，会的。如果我们的工程师立即了解每项部署对我们云账单的影响，他们就可以主动控制成本。所以我们体现了主动而非被动的概念。我们开始按小时管理云成本，而不是每 30 天等待一次云账单，然后从那里开始调整/低调恐慌。

这是值得的。我上面引用的那个 40%的数字？这使得我们的成本从每月大约 100，000 美元降低到 60，000 美元。按年计算，这相当于节省了 480，000 美元，相当于三个全职员工。我们早就应该这样做了。

Our cloud spend over 3 months

## 授权给我们的工程师

为了让我们的工程师能够自下而上地控制云支出，我们必须实施几个步骤。

1.  我们让我们所有的工程师都可以访问他们个人应用、微服务和集群的云成本。这是他们从未见过的粒度级别。在此之前，工程师只能看到纯粹的“云基础设施”视图。

2.  所有工程师都必须将他们的部署、自动扩展和 Kubernetes 配置更改与云成本相关联，以便他们可以看到他们的行动所带来的财务影响。这被证明是影响真正变革的关键。

3.  每个工程团队和应用都分配了适当的云预算，根据当月的实际和预测使用情况向他们发出警报。这些主动警报是在 Slack 中收到的，因此很容易看到。

4.  团队每两周会面一次，审查云消费和支出。

## 优化我们的基础设施

除了人的方面，我们还在基础设施方面做了一些改进。我们专注于我们知道会产生最大影响的两个类别。

### 工具资源:

1.  我们删除了 Jenkins 集群中未使用的节点池(用于应用程序构建)。
2.  我们删除了 QA 环境中未使用的名称空间。

### 驾驭 SaaS 的基础设施(有趣的东西):

1.  首先，我们优化了微服务的日志记录，因此它们从 StackDriver 日志记录中消耗的存储更少。
2.  我们缩小了显示高闲置成本的生产集群(用于我们的机器学习微服务)的规格。
3.  我们将非 prod Kubernetes 集群切换到可抢占的实例(通俗地说，它们在使用 24 小时后被当场销毁)。
4.  此外，我们修复了一个自动扩展配置问题，该问题是在我们的一个微服务的 QA 中检测到的。
5.  最后，我们实施了 Kubernetes pod 中断预算，以便当底层计算节点退役时，pod 完全可用。

Idle costs over time

通过这些易于实施的变化，我们看到我们的云成本大幅下降，您也可以做到。由于我们自己的云成本优化工作，我们创建了一个新的解决方案，我们称之为云成本管理。该软件使其他组织能够授权其开发人员和开发人员自下而上地控制云成本，就像我们在 Harness 所做的那样。

## 我们的客户通常会在云成本上超支

随着时间的推移，我们已经能够很好地掌握我们的客户在云中超支的地方。这里有一个免费赠品:有一种趋势是，工程师使用 [Kubernetes](https://kubernetes.io/) / [ECS](https://aws.amazon.com/ecs/) 和**部署微服务，使他们的集群基础设施超出 30-40%** 。

我们的大多数客户每年都在部署 10-20 项新的微服务，为什么会出现这种情况呢？嗯，猜测/安全是一个核心原因:工程师不知道他们在生产中需要什么资源，所以他们高估了。如果您的云成本正在飙升，进行审计并弄清楚五个 w 总是一个好主意:什么、为什么、谁、哪里和何时？

## 我们的客户体验到的一些真实的云成本节约

[**Relativity**](https://harness.io/blog/continuous-efficiency/relativity-masters-kubernetes-costs-with-harness-continuous-efficiency-and-saves-6-figures-in-30-days/) 通过检测 Azure Kubernetes 集群中与新微服务相关的低效微服务，利用云成本管理，在头 30 天内实现了六位数的年度节约。

[**GoSpotCheck**](https://harness.io/blog/gospotcheck-masters-microservices/) 由于现有调配资源的高闲置成本，其搜索 API 微服务的云支出减少了 80%。

**一位零售客户**配置了一个价值 1，600，000 美元的 Kubernetes 集群，该集群以 85%的空闲率运行。在修复集群的 3 天内，他们看到了 6 位数的节约。这只是数百个星团中的一个。

[**Tyler Technologies，Inc .**](https://harness.io/blog/customer-success/tyler-technologies-saves-1-2-million-in-ci-cd-maintenance-costs/)**-**“在 Tyler，我们希望我们的工程团队能够完全控制他们的应用和服务，包括管理他们的成本。泰勒科技公司的首席技术官杰夫·格林说:“由于我们的集群托管着来自许多不同泰勒业务部门的应用，以前我们的财务团队很难准确地将云计算成本分配到正确的损益上。****

****“有了安全带，这项任务变得微不足道，我们可以将这一责任转移下去。云成本管理减轻了我们财务团队的负担，让我们的工程师能够了解他们的成本，以及他们需要的工具和洞察力来[降低成本](https://harness.io/blog/reduce-cloud-costs/)并使他们的服务尽可能高效地利用资源。”****

## ****我们喜欢节省云成本。不是吗？****

****公司身体力行不是很好吗？我们存了一大笔钱，我们很乐意帮助你们也存一大笔钱，这样你们也可以像史矛革一样坐在他的宝藏和黄金山上。立即尝试利用[云成本管理](https://harness.io/platform/cloud-cost-management/)。****

****您想了解更多关于现有工具的信息吗？我们制定了要考虑的顶级[云成本管理工具](https://harness.io/blog/cloud-cost-management-tools/)。****

****-****

****如果您想更详细地了解我们的流程变化及其影响，这里有一个方便的表格。****

******之前问题之后**访问首席财务官、首席技术官、&开发首席财务官、首席技术官、开发人员、经理、&工程师云账单 100，000 美元/月 60，000 美元/月成本管理被动主动&持续预测季度可见性仅基础架构(云服务)。基础设施、应用、微服务、&生产/R & D (QA)。预算基于总支出。基于粒度支出(生产/研发& D、微服务、&基础设施)。r&d 合理优化。在不影响新计划的情况下显著降低开支。将非关键工作负载移至可抢占的实例，删除未使用的节点&命名空间。生产得到合理优化。显著降低，但不影响性能。减少日志记录、ml/ai 集群和适当规模集群的闲置支出。承诺使用 4.3 倍。CPU 从 1600 下降到 950(承诺为 700)。降低成本所花费的时间每月 1-2 小时每月 4-5 小时成本触发因素基于使用量的峰值开发人员数量的增加，新产品的投资，&COVID 带来的控制成本。****