<html>
<head>
<title>How to Implement CI/CD Efficiently | Harness</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>如何有效实施| Harness</h1>
<blockquote>原文：<a href="https://www.harness.io/blog/implement-ci-cd-efficiently#0001-01-01">https://www.harness.io/blog/implement-ci-cd-efficiently#0001-01-01</a></blockquote><div><p>让我们来探讨如何采用CI/CD来提高组织的效率和交付渠道。</p><div fs-richtext-element="rich-text" class="blog-rtf w-richtext"><p>DevOps在软件开发团队中越来越受欢迎。考虑到以下好处，这并不奇怪:简化的工作流导致更快的发布频率和部署周期，更快的错误检测，在任何错误情况下的有效回滚，以及整体上更有生产力的团队。DevOps工程师确保代码开发、测试和发布的流程和实践得到简化，以减少低效、风险和上市时间。结合<a href="https://harness.io/blog/what-is-continuous-integrationhttps://harness.io/blog/what-is-continuous-integration">持续集成(CI) </a>和<a href="https://harness.io/blog/what-is-continuous-delivery">持续交付(CD) </a>，DevOps通过自动化与代码部署相关的手动任务，帮助IT组织简化开发流程。让我们来探讨如何采用CI/CD来提高您组织的效率和交付渠道。</p><h2>连续累计</h2><p>首先，我们来看看什么是CI/CD，它的好处是什么。尽管这两个概念经常被放在一起讨论，但是它们在软件开发过程中各有自己的角色。</p><p>持续集成是自动构建和测试代码的过程。它需要一个SaaS构建服务(比如Harness托管的构建)或者一个<a href="https://app.harness.io/auth/#/signup/?module=ci?utm_source=internal&amp;utm_medium=social&amp;utm_campaign=community&amp;utm_content=replace&amp;utm_term=get-started">内部构建服务器</a>，负责从源代码控制系统(比如Git)获取代码，编译它，并测试它以确保它没有错误。这有助于通过确保错误/失误/缺陷一出现就被发现来保持软件项目的正常运行。如果一个构建被破坏了，它会暂停剩下的过程，直到它被修复。因此，构建过程更加简化。</p><h2>持续交付和部署</h2><p>连续交付自动化了发布过程。它确保代码总是处于可发布的状态。这个过程包括从构建系统中获取代码，并通过一个阶段化环境对其进行路由，以确保它适合发布。结果是一个完全自动化的部署过程，它可以由团队控制，也可以由团队外部的触发器触发(比如当开发人员向主分支推送或提交代码时)。CI和CD的关键区别在于前者专注于构建代码，而后者专注于发布最终产品。</p><p>下图描述了CI、CD和<a href="https://harness.io/blog/continuous-deployment">连续部署</a>之间的区别。</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth"/><p>持续部署是CI/CD流程的最后也是最需要的阶段。这是团队可以零接触自动化部署代码的时候。这就是持续交付和部署的区别。当代码的部署通过人工干预完成时，这就是交付。然而，如果代码是在没有任何人工干预的情况下以自动化的方式部署的，这就叫做连续部署。</p><h2>如何在您的组织中实施CI/CD</h2><p>在您的组织中实施CI/CD之前，您应该知道您为什么要实施它，目标是什么，以及您希望关注哪个指标。例如，DevOps团队通常关注四个关键(<a href="https://cloud.google.com/blog/products/devops-sre/using-the-four-keys-to-measure-your-devops-performance"> DORA </a>)指标:</p><ol role="list"><li><em>变更的交付时间</em></li><li><em>改变失败率</em></li><li><em>部署频率</em></li><li><em>平均恢复时间</em></li></ol><p>您的CI/CD目标也可以很简单，从传统软件交付实践转移到云原生实践。这样，理解DevOps概念的基础变得非常重要。</p><p>如果您还没有，您可能需要采用一个版本控制系统，实现一个构建系统，并引入阶段环境。一旦这些基础工作就绪，您就可以开始CI/CD流程了:</p><ol role="list"><li>首先，您将从CI开始。这个过程确保代码经过测试，并且是干净的，随时可以部署。</li><li>然后，您可以转移到CD部分，在那里您将能够将代码部署到阶段，并准备好供团队审查。</li><li>一旦一切都被批准，您就可以将代码部署到生产环境中。</li></ol><p>接下来，您需要评估不同的CI/CD工具，以了解哪种工具最适合您的组织。不幸的是，有太多的工具会让你们有些人不知所措。在本文中，我们将使用一个著名的CI/CD工具Harness，通过一个简单的hello world应用程序来解释CI/CD是如何工作的。一个完善的CI/CD管道还可以让您的团队更容易地确定需要改进的地方，并采取措施降低系统中可能存在的风险。随着您的团队随着时间的推移而成长和变化，这也使得实现过程变更变得更加容易。</p><h2>线束CI/CD教程</h2><p>在本教程中，我们将只关注创建带有线束的CI/CD管道。我们也是GitOps的忠实粉丝，我们有<a href="https://harness.io/blog/generally-available-harness-gitops-as-a-service"> GitOps-as-a-service </a>可用于加速您的部署。</p><p>采用CI/CDpipeline的软件开发团队看到了更快的软件部署，风险更小，错误识别和修复更快。如果您是CI/CD的新手，似乎需要学习大量的新术语和流程。但是建立一个<a href="https://docs.harness.io/article/3amcd8hn53-ci-pipeline-basics"> CI/CD管道</a>比你想象的要容易。</p><p>CI/CD管道有助于您的团队在问题到达最终用户之前，查明软件中可能出现问题的地方。此外，它允许您更频繁地发布更新，并在向用户发布之前花更少的时间测试单个组件或模块。Harness是CI/CD领域的领导者，拥有无可挑剔的特性。今天，我们将向您展示如何通过简单的设置在几分钟内实施CI/CD。</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth"/><h3>先决条件</h3><ul role="list"><li>免费<a href="https://app.harness.io/auth/#/signup/?utm_source=internal&amp;utm_medium=social&amp;utm_campaign=community&amp;utm_content=pavan_cicd_article&amp;utm_term=get-started">利用客户</a>进行CI/CD(内部)</li><li>Kubernetes从任何云提供商处访问集群来部署我们的应用(您也可以使用<a href="https://minikube.sigs.k8s.io/docs/start/"> Minikube </a>或<a href="https://kind.sigs.k8s.io/docs/user/quick-start/"> Kind </a>来创建单节点集群)。</li><li>Docker，最好是<a href="https://www.docker.com/products/docker-desktop/"> Docker桌面</a></li><li>下载并安装<a href="https://nodejs.org/en/download/"> Node.js </a></li></ul><p>首先，我们将创建一个简单的"<em> Hello World！</em>“node . js中的应用，带有一个简单的测试用例。我已经创建了这个简单的“Hello World！”应用程序来使它更容易，并把它推到GitHub。你可以<a href="https://github.com/pavanbelagatti/harness-ci-example">叉这个回购</a>开始工作。</p><p>您在repo中看到的Docker文件将用于构建我们的应用程序，并将其作为映像推送到Docker Hub。接下来，我们将构建映像，并使用命令将其推送到Docker Hub，</p><h6>docker buildx build-platform = Linux/arm 64-platform = Linux/amd64-t docker.io/<docker hub="" username="">/<image name="">:<tag>-push-f ./docker文件.</tag> </image> </docker></h6><p>一旦构建和推送成功，您可以通过您的Docker Hub帐户进行确认。</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth"/><p>您可以在分叉的repo中看到deployment.yaml文件，它定义了部署yaml文件来帮助我们将应用程序部署到我们的Kubernetes集群。此时，确保您的Kubernetes集群已经启动并运行。</p><p>一旦一切就绪，就该建立一个线束帐户来做CI/CD了。创建一个免费的线束帐户和你的第一个项目。一旦您在Harness注册，您将获得新的CI/CD体验和功能。</p><p>添加所需的连接器、GitHub repo、Docker Hub和secrets(如果有)。Harness中的Delegate是一个服务/软件，您需要在目标集群(在我们的例子中是Kubernetes集群)上安装/运行，以将您的工件、基础设施、协作、验证和其他提供者与Harness Manager连接起来。第一次设置线束时，安装线束委托。</p><figure class="w-richtext-figure-type-image w-richtext-align-center"/><p>选择持续集成模块，并添加必要的阶段和步骤，如下所示。</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth"/><p>“测试”步骤设置如下:</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth"/><p>“推送至Docker注册表”步骤如下:</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth"/><p>接下来，设置部署管道。</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth"/><p>在“服务”选项卡中添加所需的详细信息。</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth"/><p>在“环境”选项卡中定义环境类型。</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth"/><p>通过选择您喜欢的部署来制定执行策略。</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth"/><p>保存所有内容并运行管道。</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth"/><p>您可以看到CI和CD都按照指定的所有步骤逐一执行。</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth"/><p><strong>恭喜你！</strong>我们使用Harness平台成功构建并测试了应用程序代码，并将其部署到我们的Kubernetes集群上。</p><p>您可以使用命令<strong> kubectl </strong> get pods来确认这个部署</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth"/><p>您可以在deployment.yaml文件中看到两个副本按照我们的规范运行。</p><p>此外，请访问您的Kubernetes仪表盘进行确认。由于我正在使用谷歌云(GCP)，我可以看到并确认有两个豆荚运行。</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth"/><p>Harness platform使开发人员可以通过利用不同的可用模块来简化他们的SDLC。今天我们看到了CI和CD模块，到目前为止Harness总共有七个模块。</p><figure class="w-richtext-figure-type-image w-richtext-align-fullwidth"/><h2>CI/CD和DevOps</h2><p>CI/CD是任何DevOps战略的重要组成部分。它有助于自动化代码审查和测试过程，使团队更容易测试和部署软件。这也是创造持续改进文化的重要部分。同样重要的是要记住，CI/CD不是灵丹妙药。奠定<a href="https://www.atlassian.com/team-playbook/examples/devops-culture"> DevOps文化</a>和方法论是最初的步骤。同样重要的是要记住，DevOps下的这些流程和方法不是静态的；它们是不断发展的，应该根据需要进行调整以满足团队的需求。</p><p>如果您有兴趣了解有关使用Harness和智能软件交付的更多信息，<a href="https://app.harness.io/auth/#/signup">免费试用</a>并查看我们的<a href="https://developer.harness.io/">开发者中心</a>以获得更多分步教程、视频和参考文档。</p></div></div>    
</body>
</html>